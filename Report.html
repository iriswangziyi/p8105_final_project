<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Author: Amy Pitts (ajp2257), Ruiyang Li (rl3034), Wenbo Fei (wf2270), Ziyi Wang (zw2716)" />


<title>Beer Taxation Report in US</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.15/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Taxation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="taxation.html">Taxation Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_tax_state_map.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Consumption
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="consumption.html">Consumption Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_comsum_statemap.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Production
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="production.html">Production Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_production.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li>
  <a href="analysis.html">Statistical Analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Report.html">Project Report</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-envelope fa-lg"></span>
     
    Contact Us
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mailto:&lt;ajp2257@columbia.edu&gt;">Amy Pitts</a>
    </li>
    <li>
      <a href="mailto:&lt;rl3034@columbia.edu&gt;">Ruiyang Li</a>
    </li>
    <li>
      <a href="mailto:&lt;wf2270@columbia.edu&gt;">Wenbo Fei</a>
    </li>
    <li>
      <a href="mailto:&lt;ziyi.w@columbia.edu&gt;">Ziyi (Iris) Wang</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.youtube.com/">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/iriswangziyi/p8105_final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Beer Taxation Report in US</h1>
<h4 class="author">Author: Amy Pitts (ajp2257), Ruiyang Li (rl3034), Wenbo Fei (wf2270), Ziyi Wang (zw2716)</h4>

</div>


<div id="to-learn-our-project" class="section level3">
<h3>To learn our project:</h3>
<ul>
<li>A short <a href="put%20screencast%20link%20here">review</a> of our project</li>
<li>Explore more on our <a href="https://iriswangziyi.github.io/p8105_final_project">website</a></li>
<li>Find our Github <a href="https://github.com/iriswangziyi/p8105_final_project">repository</a></li>
</ul>
</div>
<div id="motivation" class="section level3">
<h3>Motivation:</h3>
<p>Statistics have been intertwined with beer since the 20th century. During his time at Guinness Brewing Company of Dublin, Ireland mathematician Gosset published a paper in 1904 about using a Poisson distribution to model the amount of yeast cells in the Beer fermentation process (The Lady Tasting Tea). This helped lead to a much more accurate assessment of the concentration of yeast cells in the beer mash and thus a much more consistent product was produced by Guinness. However, due to not wanting to leak company secrets Guinness did not let Gosset publish in appropriate papers, this led him to publish his work under the name “Student” while he worked under Pearson (The Lady Tasting Tea).</p>
<p>Beer has been around for centuries. When the Mayflower set sail from America they loaded up on all the essentials including lots of beer and when they ran out they decided to stop as soon as possible landing them on Plymouth rock. “We could not now take time for further search… our victuals being much spent, especially our beer…” <a href="https://www.beerinstitute.org/news-media/additional-beer-resources/beer-american-history/">Beer &amp; American History</a>. To their surprise, the Native Americans had been brewing beer from maize way before they invaded their land. After that point brewers have been popping up all over the United States. Beer had become so important in the establishment of the American nation that “George Washington’s first acts as Commander of the Continental Army was to proclaim that every one of his troops would receive a quart of beer with his daily rations” <a href="https://www.beerinstitute.org/news-media/additional-beer-resources/beer-american-history/">Beer &amp; American History</a>.</p>
<p>Fast forward to after the prohibition the American Government continues to control the consumption and production of Beer through regulations and taxes. The Alcohol and Tobacco Tax and Trade Bureau protects “the public by enforcing the provisions of the Federal Alcohol Administration Act” <a href="https://www.ttb.gov/alcohol/beverage-alcohol">TTB.gov</a>. This helps regulate people who engage in the alcohol beverage industry by requiring people to file an application before engaging in business. For Breweries in particular they are required to file the yearly Brewer’s Report of Operations (TTB F 5130.9) and the Quarterly Brewer’s Report of Operations (TTB F 5130.26) <a href="https://www.ttb.gov/beer/statistics">TTB.gov Statistics</a>. The Breweries must report this information no later than 15 days after the close of the applicable reporting period <a href="https://www.ttb.gov/beer/statistics">TTB.gov Statistics</a>. Through this reporting and taxation, the U.S. profits enormously off of this one beverage. From a report, it is estimated that the American beer industry contributes to “more than $328 billion to our economy” <a href="https://www.beerinstitute.org/beer-policy/overview/">Beer Institute</a>. The jobs it creates are in a wide range of areas such as farming, manufacturing, construction, transportation, service, and more. Since beer plays such an important role in the U.S. economy it is important to analyze the publicly available government data all about taxation and production <a href="https://www.ttb.gov/alcohol/beverage-alcohol">TTB.gov</a>. It is also equally interesting to look at the types of beer produced, location of breweries across the globe using an open-source API data set <a href="https://data.opendatasoft.com/explore/dataset/open-beer-database%40public-us/table/">Open Beer Dataset</a>. Our goal in this project is to get a better understanding of the taxation, consumption and production of beer by each state to get a better understanding of how the United States profits off beer.</p>
</div>
<div id="related-work" class="section level3">
<h3>Related work:</h3>
<p>There has been a lot of research into overall how the United States economy is profiting off of beer. Below is a list of related work done on summarizing taxation of beer and how it plays a role in our economy.</p>
<ul>
<li>The first taxation summary report that sparked our interest was done by <a href="https://www.nbwa.org/sites/default/files/NBWA_Report_2009.pdf">KPMG</a>. This report described the history of taxation of beer and how it has changed over time. It also explained the profit gathered, jobs created and product produced. In depth description of the specific types of taxes are also described.</li>
<li>The <a href="https://www.nbwa.org/government/state-policy-issues">American’s Beer Distributor</a> has a great compilation of all types of laws that affect how beer is taxed. This summary gives a great overview at all the moving parts of taxation as well as additional sources to learn more. This source was also where we got more data.</li>
<li>One type of taxation is <a href="https://www.nbwa.org/government/benefits-of-beer-franchise-laws">Beer franchise law</a>. These laws help local brewers can be competitive in the marketplace. Although there are a lot of nuances behind these laws they are in place to help consumers be able to have lots of choices and breweries have access to ways to promote themselves. This inpacks our analysis because through all the different ways breweries are tax really influence the tax rate of the beer and the cumulative tax growth per year.</li>
<li>Another great documentation of state taxation laws is collected on the <a href="https://www.ncsla.org/State-Officials.html">NCSLA webpage</a>. This webpage split the states up into two type of taxation laws, License Jurisdiction and Control Jurisdiction. There two different types of government power influence how breweries operate and how taxation happens. This webpage and further description on each state inspired our Analysis page. Please go to that page to read more about our search to see if these two types of Jurisdictions influence taxation between states.</li>
<li>The <a href="https://www.alcohollawreview.com/category/alcohol-regulation/">Alcohol Law Review</a> has an up to date complication of all the new laws that are being passed about alcohol. This can be anything from taxation to how alcohol can be shipped to consumption laws. It is also a historial bank of all alcohol related laws.</li>
</ul>
</div>
<div id="initial-questions" class="section level3">
<h3>Initial questions:</h3>
<ul>
<li>How much profit and product does each state in the US make each year?</li>
<li>How does the tax rate change over time per state? Which state gives more beer tax? Any trends?</li>
<li>What category/brewer/style of beer has the most Alcohol by volume (ABV)?</li>
<li>Map location of each US brewer with interactive label showing category/style, size of marker showing ABV.</li>
</ul>
<p>What questions are you trying to answer? How did these questions evolve over the course of the project? What new questions did you consider in the course of your analysis?</p>
<ul>
<li>What is the cumulative/average taxation over time in each state?</li>
<li>What is the beer consumption per capita over time in each state?</li>
<li>Where are all the US breweries located?</li>
<li>What is the average alcohol by volume (ABV) in each state?</li>
<li>What is the common beer style in each state?</li>
<li>What is the top 8 beer style?</li>
<li>What is the number of barrels/cans and bottles of beer produced by each state?</li>
<li>What is the amount of shipments made of malt beverages?</li>
<li>Is there a difference in tax/cumulative tax/tax per barrel between the two jurisdiction groups?</li>
<li>Is there a linear relationship between taxation and jurisdiction group, year, shipments, population, and consumption?</li>
</ul>
</div>
<div id="data-source-scraping-method-cleaning" class="section level3">
<h3>Data: source, scraping method, cleaning</h3>
<ul>
<li>Dataset 1</li>
</ul>
<p>Yearly Statistical Beer Data by State (2008 – 2019) from <a href="https://www.ttb.gov/beer/statistics">Alcohol and Tobacco Tax and Trade Bureau</a>. This aggregated data contained records on Tax Determined, Taxable Volume of Bottles and Cans, Taxable Volume of Barrels and Kegs each year for each state in barrels.</p>
<pre class="r"><code>#install.packages(&quot;gdata&quot;)
site1 = &quot;http://www.ttb.gov/images/pdfs/statistics/aggregated/aggr-data-beer_2008-2019.xlsx&quot;

#Tax Determined (in Barrels)
tax_df  =  
  gdata::read.xls(site1, sheet = 1, header = T, skip = 6, nrow = 52) %&gt;% #skip note
  janitor::clean_names() %&gt;%
  select(1:13) %&gt;%
  as_tibble() %&gt;%
  rename_with( ~ sub(&quot;x&quot;, &quot;&quot;, .x)) %&gt;% # rename column names
  mutate(state = factor(state)) %&gt;% #state as factor
  mutate_at(vars(2:13), ~ gsub(&quot;,&quot;, &quot;&quot;, .x)) %&gt;% #remove &quot;,&quot; in tax values
  mutate_at(vars(2:13), as.numeric) # tax values as numeric

# Taxable Volume of Bottles and Cans* (in Barrels)
taxable_cans_df  = 
  gdata::read.xls(site1, sheet = 2, header = T, skip = 4, nrow = 52) %&gt;% 
  janitor::clean_names() %&gt;%
  select(1:13) %&gt;%
  as_tibble() %&gt;%
  rename_with( ~ sub(&quot;x&quot;, &quot;&quot;, .x)) %&gt;%
  mutate(state = factor(state)) %&gt;%
  mutate_at(vars(2:13), ~ gsub(&quot;,&quot;, &quot;&quot;, .x)) %&gt;%
  mutate_at(vars(2:13), as.numeric)

# Taxable Volume of Barrels and Kegs*
taxable_barrels_df  = 
  gdata::read.xls(site1, sheet = 3, header = T, skip = 4, nrow = 52) %&gt;% 
  janitor::clean_names() %&gt;%
  select(1:13) %&gt;%
  as_tibble() %&gt;%
  rename_with( ~ sub(&quot;x&quot;, &quot;&quot;, .x)) %&gt;%
  mutate(state = factor(state)) %&gt;%
  mutate_at(vars(2:13), ~ gsub(&quot;,&quot;, &quot;&quot;, .x)) %&gt;%
  mutate_at(vars(2:13), as.numeric)

# DT::datatable(
#   head(tax_df[,-c(2,3)]),
#   caption = &#39;Head of the tax_df dataframe, (Cummulative Tax Data)&#39;
# )
# DT::datatable(
#   head(taxable_cans_df[,-c(2,3)]),
#   caption = &#39;Head of the taxable_cans_df dataframe&#39;
# )
# DT::datatable(
#   head(taxable_barrels_df[,-c(2,3)]),
#   caption = &#39;Head of the taxable_barrels_df dataframe&#39;
# )
# write_csv(tax_df, &quot;data_import_cleaning/tax.csv&quot;)
# write_csv(taxable_cans_df, &quot;data_import_cleaning/tax_cans.csv&quot;)
# write_csv(taxable_barrels_df, &quot;data_import_cleaning/tax_barrels_df.csv&quot;)</code></pre>
<ul>
<li>Dataset 2</li>
</ul>
<p>Open Beer database from <a href="https://data.opendatasoft.com/explore/dataset/open-beer-database%40public-us/information/?rows=4588&amp;timezone=&amp;refine.country=United+States&amp;location=2,16.98232,9.498&amp;basemap=jawg.sunny&amp;dataChart=eyJxdWVyaWVzIjpbeyJjb25maWciOnsiZGF0YXNldCI6Im9wZW4tYmVlci1kYXRhYmFzZUBwdWJsaWMtdXMiLCJvcHRpb25zIjp7fX0sImNoYXJ0cyI6W3siYWxpZ25Nb250aCI6dHJ1ZSwidHlwZSI6ImxpbmUiLCJmdW5jIjoiQVZHIiwieUF4aXMiOiJhYnYiLCJzY2llbnRpZmljRGlzcGxheSI6dHJ1ZSwiY29sb3IiOiIjMTQyRTdCIn1dLCJ4QXhpcyI6Imxhc3RfbW9kIiwibWF4cG9pbnRzIjoiIiwidGltZXNjYWxlIjoieWVhciIsInNvcnQiOiIifV0sImRpc3BsYXlMZWdlbmQiOnRydWUsImFsaWduTW9udGgiOnRydWV9">Opendatasoft</a>. This dataset contains information of each beer product, including product name, universal product code, style, category, brewer along with its address and website, percentage of alcohol by volume, bitterness from hops in a beer, beer color, and description in text.</p>
<pre class="r"><code>beer_specific = 
  read_delim(&quot;https://public-us.opendatasoft.com/explore/dataset/open-beer-database/download/?format=csv&amp;timezone=America/New_York&amp;lang=en&amp;use_labels_for_header=true&amp;csv_separator=%3B&quot;, delim = &quot;;&quot;) %&gt;% # sep = &quot;;&quot;
  janitor::clean_names() %&gt;%
  filter(country == &quot;United States&quot;) %&gt;% # only investigate beer in US
  separate(coordinates, c(&quot;latitude&quot;, &quot;longitude&quot;), sep = &quot;,&quot;) # separate geographic info

# printing the head of the table 
# beer_specific_smaller = beer_specific %&gt;%
#   select(name, id, alcohol_by_volume, style, category, city, state, latitude, longitude)
# DT::datatable(
#   head(beer_specific_smaller),
#   caption = &#39;Head of the beer_specific dataframe&#39;
# )
# write_csv(beer_specific, &quot;data_import_cleaning/beer.csv&quot;)</code></pre>
<ul>
<li>Dataset 3</li>
</ul>
<p>The third dataset that was used is from the <a href="https://www.nbwa.org/resources/state-data">American Beer Distributors</a>. This website aims to collect data on beer consumption, taxation and shipment. They have produced a number of there own reports but they have the data they used avaiable in pdf form. The pdf document are <a href="https://www.nbwa.org/sites/default/files/Beer%20Excise%20Tax%202019%20-%20Revised%20July%202020.pdf">Summary of Effective State Excise Tax Rates by State</a> and <a href="https://www.nbwa.org/sites/default/files/2003%20and%202019%20State%20data%20Per%20Capita%20Sheets_1.pdf">Shipments of Malt Beverages and Per Capita Consumption by State</a>. Due to the difficult of working with pdf documents in R and pdf to excel <a href="https://pdftables.com/blog/convert-pdf-to-csv">online file converter</a> was used to access this data. These files include data on taxation rate per barrel, shipment of beer, consumption of beer per capita, and population over 21 years of age. Because the pdf converters were used the data cleaning process was made much similar then if we used R to read the pdf document directly.<br />
In our analysis we decide to only focus on the years from 2010-2019 to make it consisten with the other datasets.</p>
<pre class="r"><code># first pdf document
# We need to initalize the first year to make a dataframe. 
state_df = 
  readxl::read_excel(&quot;data_import_cleaning/2003_and_2019_State_data_Per_Capita_perpage.xlsx&quot;, 
                      sheet = 1, range = &quot;A5:F56&quot;) %&gt;% # only want specific range of cells 
                janitor::clean_names() %&gt;%
                mutate(
                  year = rep(2003, 51) # adding in a year variable 
                )

# iterate over the next couple of years which are different excel sheets. 
for( i in 2:17) { # years are (2003+1, 2019)
  state_df = rbind(state_df, readxl::read_excel(
    &quot;data_import_cleaning/2003_and_2019_State_data_Per_Capita_perpage.xlsx&quot;,
                                        sheet = i, range = &quot;A5:F56&quot;) %&gt;%
                  janitor::clean_names() %&gt;%
                  mutate(
                    year = rep(2002+i, 51) # adding in a year variable 
                  )
             ) 
}
#write_csv(state_df, &quot;data_import_cleaning/state_df.csv&quot;) # save into a clean cvs file 

## Second pdf document 
# getting the first year to initialize the dataframe. 
state_tax_df = 
  readxl::read_excel(&quot;data_import_cleaning/Beer_Excise_Tax2019Revised_July_2020perpage.xlsx&quot;, 
                          sheet = 1, range = &quot;A5:G56&quot;) %&gt;% # only want specific range of cells 
                janitor::clean_names() %&gt;%
                mutate(
                  year = rep(2009, 51) # adding in a year variable 
                )

# iterate over the next couple of sheet to get all the years 
for( i in 2:11) { # years are (2009+1, 2019)
  state_tax_df = rbind(state_tax_df, readxl::read_excel(
    &quot;data_import_cleaning/Beer_Excise_Tax2019Revised_July_2020perpage.xlsx&quot;,
                                                sheet = i, range = &quot;A5:G56&quot;) %&gt;% 
                  janitor::clean_names() %&gt;%
                  mutate(
                    year = rep(2008+i, 51) # adding in a year variable 
                  )
             ) 
}
#write_csv(state_tax_df, &quot;data_import_cleaning/state_tax_df.csv&quot;) # save into a clean cvs file</code></pre>
<pre class="r"><code># DT::datatable(
#   head(state_tax_df),
#   caption = &#39;Head of state_tax_df dataframe, (Tax per Barrel Data)&#39;
# )</code></pre>
<pre class="r"><code># DT::datatable(
#   head(state_df),
#   caption = &#39;Head of state_df dataframe&#39;
# )</code></pre>
</div>
<div id="exploratory-analysis" class="section level3">
<h3>Exploratory analysis:</h3>
<p>Visualizations, summaries, and exploratory statistical analyses. Justify the steps you took, and show any major changes to your ideas. Each of us add our part, should include code that can generate the plot(please note file path), comment on the plots and answer the above corresponding initial questions part. I will try to revise them in a reasonable order.</p>
<div id="taxation" class="section level4">
<h4>Taxation:</h4>
<div id="tax-per-barrel-averages" class="section level5">
<h5>Tax per Barrel Averages</h5>
<p>The American Beer Distributors also collected information tax per barrel unit. This measurement focuses on more than just breweries but rather taxation of beer sold anywhere. The measurement that we are displaying is an effective excise tax with a volume adjustment. In the dataset, there were two other similar variables about tax one adjusting for state tax and another for local laws about tax. However, we chose to go with the volume adjusted measurement since they all reported very similar number. his graph also shows the effective excise tax volume adjusted measurement from the year 2010 to 2019 with the corresponding confidence intervals. This can help show which states are different from each other when it comes to tax per barrel collected.</p>
<pre class="r"><code>region_name = tibble(state = state.name, state_region= state.region)

perbarrel_tax = state_tax_df %&gt;% 
  filter(state != &quot;District of Columbia&quot;) %&gt;% # we don&#39;t want this in our moving graph
  filter(year &gt; 2009) %&gt;%
  group_by(state) %&gt;%
  mutate(
    tax = adjusted
  ) %&gt;%
  summarize(
    mean_tax = mean(tax, na.rm=TRUE), 
    CI_lower = mean(tax, na.rm=TRUE) - 1.96 * sd(tax, na.rm=TRUE)/sqrt(length(tax)),
    CI_upper = mean(tax, na.rm=TRUE) + 1.96 * sd(tax, na.rm=TRUE)/sqrt(length(tax))
  ) %&gt;%
  right_join(., region_name, by = &quot;state&quot;) %&gt;% # joining the regions in so we can color the graph
  mutate(
    #state = abbr2state(state), # making the states into names instead of abbs
    state = fct_reorder(state, mean_tax) # ordering the states according to mean_barrels
  ) 

perbarrel_tax %&gt;%  # plotting!!
  ggplot(aes(x = state, y = mean_tax,color=state_region)) + 
  geom_point() + 
  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  #theme(legend.position = &quot;none&quot;)  +
  labs(
    title = &quot;Average Tax Per Barrel by State&quot;,
    subtitle = &quot;Data from years 2010-2019&quot;,
    y = &quot;Tax per Barrel&quot;,
    x = &quot;State&quot;
  )</code></pre>
<p><img src="Report_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<p>Wyoming has the lowest tax per barrel average of 0.59 dollars, while Alabama has the highest tax per barrel average of 32.94 dollars. The biggest ranges of values go to Tennessee with Washington and Delaware also having a range of values. These big ranges of value make sense because in the moving graph before these states had the most motion in moving ranks. The states that have no confidence intervals are the states that did not see changes to their tax per barrel between the years 2010-2019. Just like in the graph above we see that the South and West seem to be the dominant states in the higher tax per barrel rates with the North Central state tending to have lower tax per barrel.</p>
</div>
<div id="cumulative-tax" class="section level5">
<h5>Cumulative Tax</h5>
<p>For detailed visualization of cumulative tax for each state over the years, you can have a look at our <a href="https://iriswangziyi.github.io/p8105_final_project/viz_tax_statemap/dashboard_tax_state_map.html">data exploration</a> dashboard under “Taxation” tab. For the first page of the dashboard, we provided interactive tax trend and choropleth plots for each year, click on the point or state you can see hover information. Besides, tax data table is attached on the second page of the dashboard. Here is a sample page of dashboard. <img src="viz_tax_statemap/dashboard1.png" alt="Taxation Dashboard" />.</p>
<p>Code for generating all the dashboards can be found <a href="https://github.com/iriswangziyi/p8105_final_project/tree/main/viz_tax_statemap">here</a></p>
<p>The state with the lowest amount of taxes collected from breweries is North Dakota and South Dakota is a close second for the lowest amount of taxes. Both of these states are located in the North Central part of America. The state with the largest amount in cumulative taxes collected from breweries is California it also has most increase over the years. In second place for top cumulative tax is Colorado. These top two states are in the West part of the United States. This measurement of tax does not account for the population base or size of the state. It makes sense that California is at the top because it a state with a lot of people and that North and South Dakota is at the bottom because the population mass is much less. Overall, looking at the states, the states with a smaller population has a smaller cumulative beer tax rate.</p>
<p>More interesting and supporting plots can be found on <a href="https://iriswangziyi.github.io/p8105_final_project/taxation.html">Taxation</a> tab on our website.</p>
</div>
</div>
<div id="consumption" class="section level4">
<h4>Consumption:</h4>
<div id="average-alcohol-by-volume-by-state" class="section level5">
<h5>Average Alcohol by volume by State</h5>
<p>Alcohol by volume (ABV) is defined to be the volume percent of alcohol (ethanol) contained in a given volume of an alcoholic beverage. In our project, we are interested in exploring the pattern of ABV in beer produced in each state. This average is considering all beer that do have alcohol content. Zero values were excluded because they represented non-alcoholic beer. The color of the state represents the state region. The data we are using is of course not a complete list of every single beer made in each state but rather a sample.</p>
<pre class="r"><code>beer = read_csv(&quot;./data_import_cleaning/beer.csv&quot;)

beer %&gt;% 
  filter(alcohol_by_volume !=0 ) %&gt;%
  group_by(state) %&gt;% 
  filter(state %in% c(state.name) ) %&gt;%
  summarize(
    mean_ABV = mean(alcohol_by_volume),
    CI_lower = mean(alcohol_by_volume, na.rm=TRUE) - 
      1.96 * sd(alcohol_by_volume, na.rm=TRUE)/sqrt(length(alcohol_by_volume)),
    CI_upper = mean(alcohol_by_volume, na.rm=TRUE) + 
      1.96 * sd(alcohol_by_volume, na.rm=TRUE)/sqrt(length(alcohol_by_volume))
  ) %&gt;% 
  right_join(., region_name, by = &quot;state&quot;) %&gt;% # joining the regions in so we can color the graph
  mutate(
    state = fct_reorder(state, mean_ABV) # ordering the states according to mean_ABV
  )  %&gt;%  # plotting!!
  drop_na(mean_ABV) %&gt;%
  ggplot(aes(x = state, y = mean_ABV,color=state_region)) + 
  geom_point() + 
  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  #theme(legend.position = &quot;none&quot;)  +
  labs(
    title = &quot;Average ABV by State&quot;,
    subtitle = &quot;National ABV in beer shown by dotten lines 5%-7% &quot;,
    y = &quot;ABV content&quot;,
    x = &quot;State&quot;
  ) +
  geom_hline(yintercept=5, linetype=&quot;dashed&quot;, 
                color = &quot;black&quot;, size=1)+
  geom_hline(yintercept=7, linetype=&quot;dashed&quot;, 
                color = &quot;black&quot;, size=1)</code></pre>
<p><img src="Report_files/figure-html/unnamed-chunk-4-1.png" width="768" /></p>
<p>The dotted lines at 5% and 7% represent the national average of Alcohol content in beer according to the <a href="https://nclnet.org/alcohol_how_it_all_adds_up/#:~:text=One%20ounce%20of%20beer%20contains,5%20percent%20alcohol%20by%20volume">National Consumers League</a>. From this graph, we see that 5 states have averages well below that range (Idaho, Utah, Mississippi, Iowa and Tennessee) and 6 states have an average well above that range (Maryland, Wyoming, Alaska, Illinois, Flordia and Deleware). Looking specifically at Delaware the 95% lower bound of its confidence interval is well above 7% implying that this state produces beer that has an alcohol content larger than the national average in a regular beer.</p>
</div>
<div id="consumption-per-capita" class="section level5">
<h5>Consumption per Capita</h5>
<p>For detailed visualization of consumption per Capita for each state, you can have a look at our <a href="https://iriswangziyi.github.io/p8105_final_project/viz_tax_statemap/dashboard_comsum_statemap.html">data exploration</a> dashboard under “consumption” tab. For the first page of the dashboard, we provided interactive consumption trend and choropleth plots for each year, click on the point or state you can see hover information. Besides, consumption data table is attached on the second page of the dashboard. Here is a sample page of dashboard. <img src="viz_tax_statemap/dashboard2.png" alt="Consumption Dashboard" />.</p>
<p>First, we see Utah constantly at the bottom throughout all years. The top per Capita consumption rates are from New Hampshire, Montana, and North Dakota. These three states are very interesting because they have been towards the bottom of the list on the taxation and production page. One explanation is that these three states do not have very big populations so consumption is divided by a smaller number making the measurement look larger. The second explanation is that all these states have a low tax per barrel cost therefore people from out of state might travel to purchase alcohol. Interviewing friends and family from the North East traveling to New Hampshire to buy alcohol common because they do not have sales tax. There are 5 states that do not have sales tax as of 2019 Alaska, Delaware, Montana, New Hampshire, and Oregon. This helps explain why New Hampshire and Montana are so high up on the list, not only do they have no sales tax but they also have small populations making their consumption per capita large. According to the same source, California has the highest state-level sales tax which helps explain why it is so low on our rankings here but high up in the ranking on the Taxation and Production page.</p>
<p>More interesting and supporting plots can be found on <a href="https://iriswangziyi.github.io/p8105_final_project/consumption.html">Consumption</a> tab on our website.</p>
</div>
</div>
<div id="production" class="section level4">
<h4>Production:</h4>
<div id="production-of-barrels-and-kegs" class="section level5">
<h5>Production of Barrels and Kegs</h5>
<p>This graph looks at the taxable volume of beer Barrels and Kegs produced by state recorded in barrel units. The points represent the mean production from 2010-2019 and the lines show corresponding confidence intervals. The data comes from the Alcohol and Tobacco Tax and Trade Bureau data set. This visualization helps us see the difference in barrel and kegs production of each state. The colors represent the state’s region and they will stay consistent through this page.</p>
<pre class="r"><code># setting up the regions
region = tibble(state = state.abb, state_region= state.region)

barrel = taxable_barrels_df %&gt;% # first we need to pivot the data 
  filter(state != &quot;total&quot;) %&gt;%
  pivot_longer(
    c(`2008`:`2019`),
    names_to = &quot;year&quot;,
    values_to = &quot;barrels&quot;
  )%&gt;%
  filter(year &gt; 2009) %&gt;% # we want to only focus on years 2010-2019
  group_by(state) %&gt;%
  mutate(
    barrels_log = barrels
  ) %&gt;% 
  summarize(
    mean_barrel = mean(barrels_log, na.rm = TRUE), # finding the mean barrels
    CI_lower = mean(barrels_log, na.rm = TRUE) - 
      1.96 * sd(barrels_log, na.rm = TRUE)/sqrt(length(barrels_log)), # finding the lower CI
    CI_upper = mean(barrels_log, na.rm = TRUE) + 
      1.96 * sd(barrels_log,na.rm = TRUE)/sqrt(length(barrels_log)) # finding the upper CI
  ) %&gt;%
  right_join(., region, by = &quot;state&quot;) %&gt;% # joining the regions in so we can color the graph
  mutate(
    state = usdata::abbr2state(state), # making the states into names instead of abbs
    state = fct_reorder(state, mean_barrel) # ordering the states according to mean_barrels
  ) 
barrel %&gt;%  # plotting!!
  ggplot(aes(x = state, y = mean_barrel,color=state_region)) + 
  geom_point() + 
  geom_errorbar(aes(ymin = CI_lower, ymax = CI_upper)) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
  labs(
    title = &quot;Taxable Volume of Barrel Production by State&quot;,
    subtitle = &quot;Data from years 2010-2019&quot;,
    y = &quot;Taxable Volume (in Barrels)&quot;,
    x = &quot;State&quot;
  )</code></pre>
<p><img src="Report_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<p>The state with the least amount of taxable barrel volume is North Dakota (1740.12) with South Dakota (2033.03) very close by. The state with the most barrel production in California (2,195,187) with Colorado (1,994,354) in second place. The trend in this graph appears to be exponential growth. The upper half of the states seem to produce a significant amount more barrels compare to the lower states. This cut off seem to be around Washington. There is a huge gap between Florida and Ohio. The states Ohio, Colorado, and California seem to make an exponential amount more of taxable barrels than the other states.</p>
<p>These findings also make sense comparing the locations of the top states to the bottom states. The <a href="https://iriswangziyi.github.io/p8105_final_project/consumption.html#Brewery_locations">brewery location</a> interactive map showed that states on coastlines or on the edges of the United States has more brewery location, therefore they produce more taxable volume. The states in middle America did not have a lot of brewery location so it makes sense that they don’t produce a lot of taxable volume of beer.</p>
<p>For detailed visualization of production trend for each state, you can have a look at our <a href="https://iriswangziyi.github.io/p8105_final_project/viz_tax_statemap/dashboard_production.html">data exploration</a> dashboard under “production” tab. For the first page of the dashboard, we provided interactive production trend plots for “Barrels and Kegs” and “Bottles and Cans”, click on the point you can see hover information. Besides, production data table is attached on the second page of the dashboard. Besides, production data table is attached on the second page of the dashboard. Here is a sample page of dashboard. <img src="viz_tax_statemap/dashboard3.png" alt="Production Dashboard" />.</p>
<p>More interesting and supporting plots can be found on <a href="https://iriswangziyi.github.io/p8105_final_project/production.html">Production</a> tab on our website.</p>
</div>
</div>
</div>
<div id="additional-analysis-regression" class="section level3">
<h3>Additional analysis: Regression</h3>
<p>We focus on two analyses in our project. One is to compare tax differences by jurisdiction group over time. The other is to model taxation under the regression analysis framework. More details can be found in the Analysis section on our website (link to be inserted here).</p>
<p><strong>1. Preliminary Analysis</strong> – Tax differences by jurisdiction group</p>
<p><strong>Motivation</strong></p>
<p>Differing on the degree of control on liquor wholesales and retail, states can be categorized into two <a href="https://www.ncsla.org/State-Officials.html">types</a> – control jurisdiction and licensed jurisdiction, with licensed states having more control. Such categorization may lead to difference in taxation. Therefore, we are interested in examining if there is any difference in taxation by these two groups of states.</p>
<p><strong>Procedures</strong></p>
<p>We performed t-test for each year from 2010 to 2019 and would like to see if there is any significant difference in the cumulative tax between control states and licensed states.</p>
<p><strong>Findings</strong></p>
<p>Based on the test results, however, we did not find sufficient evidence showing any significant difference between two jurisdiction groups in both the cumulative tax collected and the tax per barrel from 2010 to 2019.</p>
<p>We speculated that there may be some confounding variables that could potentially affect the relationship between taxation and the jurisdiction group. Therefore, we decided to further perform regression analysis. Specifically, we would like to explore more regarding the relationship between taxation and jurisdiction group, year, shipments, population, and consumption.</p>
<p><strong>2. Regression Analysis</strong></p>
<p><strong>Variables of interest</strong></p>
<p>Our explaining variables of interest include jurisdiction group, year, shipments, population, and consumption. Their detailed explanation are as below.</p>
<ul>
<li>group: jurisdiction group (control vs licensed)</li>
<li>shipments: amount of barrels shipped</li>
<li>population: the number of individuals who are 21 years old or older</li>
<li>consumption: consumption of barrels per capital</li>
</ul>
<p><strong>Model</strong></p>
<p>Our intended model is</p>
<p><span class="math display">\[Tax = \beta_0 + \beta_1 \ Group + \beta_2 Year + \beta_3 \ Shipments + \beta_4 \ Population+ \beta_5 \ Consumption\]</span></p>
<p>We looked at both the cumulative tax collected and the tax per barrel.</p>
<p><strong>Results &amp; Findings</strong></p>
<p>In the model of the <strong>tax per barrel</strong>, all the variables are <strong>not significant</strong> at the 5% significance level; further the model is poorly fitted as the adjusted <span class="math inline">\(R^2\)</span> is approximately 0. Therefore, we will mostly focus on the cumulative tax collected.</p>
<p>In the model of <strong>cumulative tax collected</strong>, we found that:</p>
<ul>
<li>All variables in our model are <strong>significant</strong> at the 5% significance level.</li>
<li>Our model fit is acceptable with an adjusted <span class="math inline">\(R^2 = 0.55\)</span>.</li>
<li>Previously, we did not find any significant difference in the cumulative tax between two jurisdiction groups. However, after controlling for year, shipments, population and consumption, we found that <strong>licensed states</strong> are estimated to have approximately <strong>7.5k less cumulative tax collected</strong> than the control states.</li>
<li><strong>Cumulative tax collected</strong> is estimate to <strong>increase approximately 7k per year</strong>, holding the group, shipments, population and consumption unchanged.</li>
<li>Cumulative tax collected is estimated to <strong>increase approximately 1k for one unit increase in consumption per capita</strong>, holding the group, year, shipments, and population unchanged.</li>
<li>Population and shipments have estimated coefficients close to 0, though they have significant p-values.</li>
</ul>
<pre class="r"><code># Load datasets
state_df = read_csv(&quot;data_import_cleaning/state_df.csv&quot;)
tax_df = read_csv( &quot;data_import_cleaning/tax.csv&quot;)

# state and its abbreviation
# https://abbreviations.yourdictionary.com/articles/state-abbrev.html
state_ref = 
  read.delim(&quot;./data_import_cleaning/state_abbreviation.txt&quot;, header = F) %&gt;%
  separate(V1, into = c(&quot;state&quot;, &quot;state_abbrv&quot;), sep = &quot; - &quot;) 

# jurisdiction information
license = 
  read_table(&quot;./data_import_cleaning/license_jurisdiction_modified.txt&quot;) %&gt;%
  unlist()
control = 
  read_table(&quot;./data_import_cleaning/control_jurisdiction_modified.txt&quot;) %&gt;%
  unlist()

# tidy tax data: state with abbreviation + group
# to be consistent with other plots, remove year 2008, 2009 (starting year is 2010)
tax_df_group =  
  left_join(tax_df %&gt;% rename(state_abbrv = state), 
            state_ref, by = &quot;state_abbrv&quot;) %&gt;% 
  mutate(
    group = ifelse(state %in% license, &quot;licensed&quot;, 
                   ifelse(state %in% control, &quot;control&quot;, &quot;NA&quot;))
  ) %&gt;% 
  relocate(state_abbrv, state, group) %&gt;% 
  slice(-52) %&gt;% 
  select(-`2008`, -`2009`)

# Merge dataset: tax_df_group + state_df
reg_df = 
  tax_df_group %&gt;% 
  pivot_longer(
    &quot;2010&quot;:&quot;2019&quot;, 
    names_to = &quot;year&quot;, 
    values_to = &quot;total_tax&quot;
  ) %&gt;% 
  mutate(year = as.numeric(year)) %&gt;% 
  left_join(., state_df, by = c(&quot;state&quot;, &quot;year&quot;)) %&gt;% 
  select(total_tax, group, year, shipments, population, consumption)

# Replace 0&#39;s with NA&#39;s
reg_df[reg_df == 0] &lt;- NA

# Fit model
lm_model = lm(total_tax ~ group + year + shipments + population + consumption, data = reg_df)
summary(lm_model)
## 
## Call:
## lm(formula = total_tax ~ group + year + shipments + population + 
##     consumption, data = reg_df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -90576 -15530  -4738  10976 193775 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -1.415e+07  9.800e+05 -14.437  &lt; 2e-16 ***
## grouplicensed -7.551e+03  2.973e+03  -2.540 0.011382 *  
## year           7.012e+03  4.858e+02  14.434  &lt; 2e-16 ***
## shipments     -9.523e-03  2.279e-03  -4.179 3.46e-05 ***
## population     1.365e-02  2.033e-03   6.714 5.17e-11 ***
## consumption    1.189e+03  3.396e+02   3.501 0.000504 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 30570 on 500 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.5548, Adjusted R-squared:  0.5503 
## F-statistic: 124.6 on 5 and 500 DF,  p-value: &lt; 2.2e-16

broom::tidy(lm_model) %&gt;% 
  mutate_at(2:5, round, 2) %&gt;% 
  janitor::clean_names() %&gt;% 
  rename(
    Variable = term,
    Coefficient = estimate, 
    `Standard Error` = std_error,
    `t-Statistic` = statistic, 
    `P-value` = p_value
  ) %&gt;% 
  mutate(
    Variable = ifelse(Variable == &quot;grouplicensed&quot;, &quot;Licensed Group&quot;, Variable), 
    Variable = str_to_title(Variable)
  ) %&gt;% 
  DT::datatable(., rownames = F, 
                options = list(pageLength = 10)) %&gt;% 
  DT::formatStyle(
    columns = &quot;P-value&quot;,
    background = DT::styleInterval(c(0.05),c(&quot;lightsteelblue&quot;,&quot;white&quot;)), 
    target = &quot;row&quot;)</code></pre>
<div id="htmlwidget-486ad51ffd16a56691da" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-486ad51ffd16a56691da">{"x":{"filter":"none","data":[["(Intercept)","Licensed Group","Year","Shipments","Population","Consumption"],[-14148057.06,-7551.04,7011.78,-0.01,0.01,1188.99],[980018.67,2972.68,485.77,0,0,339.58],[-14.44,-2.54,14.43,-4.18,6.71,3.5],[0,0.01,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Coefficient<\/th>\n      <th>Standard Error<\/th>\n      <th>t-Statistic<\/th>\n      <th>P-value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[4]; $(row).css({'background':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightsteelblue\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="discussion" class="section level3">
<h3>Discussion:</h3>
<p>What were your findings? Are they what you expect? What insights into the data can you make?</p>
<p>Discuss in the meeting.</p>
</div>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">


 
<hr />
<p style="text-align: center;">
A work by <a href="https://github.com/amypitts01">Amy Pitts</a>, <a href="https://github.com/ruiyangli1">Ruiyang Li</a>, <a href="https://github.com/Wenbofei">Wenbo Fei</a>, and <a href="https://github.com/iriswangziyi">Ziyi (Iris) Wang</a>
</p>
<p style="text-align: center;">
Visualizations and analyses performed using <a href="https://www.r-project.org/about.html">R</a> (v4.0.2) and <a href="https://rstudio.com">RStudio</a> (v1.3.1073).
</p>
<p style="text-align: center;">
© Copyright 2020 The Beer Project Team, All Rights Reserved | Powered by Github.io
</p>

<p> </p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
