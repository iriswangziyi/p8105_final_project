<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Author: Amy Pitts (ajp2257), Ruiyang Li (rl3034), Wenbo Fei (wf2270), Ziyi Wang (zw2716)" />


<title>Beer Taxation Report in US</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.16/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Taxation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="taxation.html">Taxation Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_tax_state_map.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Consumption
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="consumption.html">Consumption Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_comsum_statemap.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Production
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="production.html">Production Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_production.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li>
  <a href="analysis.html">Analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Report.html">Project Report</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-envelope fa-lg"></span>
     
    Contact Us
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mailto:&lt;ajp2257@columbia.edu&gt;">Amy Pitts</a>
    </li>
    <li>
      <a href="mailto:&lt;rl3034@columbia.edu&gt;">Ruiyang Li</a>
    </li>
    <li>
      <a href="mailto:&lt;wf2270@columbia.edu&gt;">Wenbo Fei</a>
    </li>
    <li>
      <a href="mailto:&lt;ziyi.w@columbia.edu&gt;">Ziyi (Iris) Wang</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.youtube.com/">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/iriswangziyi/p8105_final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Beer Taxation Report in US</h1>
<h4 class="author">Author: Amy Pitts (ajp2257), Ruiyang Li (rl3034), Wenbo Fei (wf2270), Ziyi Wang (zw2716)</h4>

</div>


<div id="to-learn-our-project" class="section level3">
<h3>To learn our project:</h3>
<ul>
<li>A short <a href="put%20screencast%20link%20here">review</a> of our project</li>
<li>Explore more on our <a href="https://iriswangziyi.github.io/p8105_final_project">website</a></li>
<li>Find our Github <a href="https://github.com/iriswangziyi/p8105_final_project">repository</a></li>
</ul>
</div>
<div id="motivation" class="section level3">
<h3>Motivation:</h3>
<p>Statistics have been intertwined with beer since the 20th century. During his time at Guinness Brewing Company of Dublin, Ireland mathematician Gosset published a paper in 1904 about using a Poisson distribution to model the amount of yeast cells in the Beer fermentation process (The Lady Tasting Tea). This helped lead to a much more accurate assessment of the concentration of yeast cells in the beer mash and thus a much more consistent product was produced by Guinness. However, due to not wanting to leak company secrets Guinness did not let Gosset publish in appropriate papers, this led him to publish his work under the name “Student” while he worked under Pearson (The Lady Tasting Tea).</p>
<p>Beer has been around for centuries. When the Mayflower set sail from America they loaded up on all the essentials including lots of beer and when they ran out they decided to stop as soon as possible landing them on Plymouth rock. “We could not now take time for further search… our victuals being much spent, especially our beer…” <a href="https://www.beerinstitute.org/news-media/additional-beer-resources/beer-american-history/">Beer &amp; American History</a>. To their surprise, the Native Americans had been brewing beer from maize way before they invaded their land. After that point brewers have been popping up all over the United States. Beer had become so important in the establishment of the American nation that “George Washington’s first acts as Commander of the Continental Army was to proclaim that every one of his troops would receive a quart of beer with his daily rations” <a href="https://www.beerinstitute.org/news-media/additional-beer-resources/beer-american-history/">Beer &amp; American History</a>.</p>
<p>Fast forward to after the prohibition the American Government continues to control the consumption and production of Beer through regulations and taxes. The Alcohol and Tobacco Tax and Trade Bureau protects “the public by enforcing the provisions of the Federal Alcohol Administration Act” <a href="https://www.ttb.gov/alcohol/beverage-alcohol">TTB.gov</a>. This helps regulate people who engage in the alcohol beverage industry by requiring people to file an application before engaging in business. For Breweries in particular they are required to file the yearly Brewer’s Report of Operations (TTB F 5130.9) and the Quarterly Brewer’s Report of Operations (TTB F 5130.26) <a href="https://www.ttb.gov/beer/statistics">TTB.gov Statistics</a>. The Breweries must report this information no later than 15 days after the close of the applicable reporting period <a href="https://www.ttb.gov/beer/statistics">TTB.gov Statistics</a>. Through this reporting and taxation, the U.S. profits enormously off of this one beverage. From a report, it is estimated that the American beer industry contributes to “more than $328 billion to our economy” <a href="https://www.beerinstitute.org/beer-policy/overview/">Beer Institute</a>. The jobs it creates are in a wide range of areas such as farming, manufacturing, construction, transportation, service, and more. Since beer plays such an important role in the U.S. economy it is important to analyze the publicly available government data all about taxation and production <a href="https://www.ttb.gov/alcohol/beverage-alcohol">TTB.gov</a>. It is also equally interesting to look at the types of beer produced, location of breweries across the globe using an open-source API data set <a href="https://data.opendatasoft.com/explore/dataset/open-beer-database%40public-us/table/">Open Beer Dataset</a>. Our goal in this project is to get a better understanding of the taxation, consumption and production of beer by each state to get a better understanding of how the United States profits off beer.</p>
</div>
<div id="related-work" class="section level3">
<h3>Related work:</h3>
<p>There has been a lot of research into overall how the United States economy is profiting off of beer. Below is a list of related work done on summarizing taxation of beer and how it plays a role in our economy.</p>
<ul>
<li>The first taxation summary report that sparked our interest was done by <a href="https://www.nbwa.org/sites/default/files/NBWA_Report_2009.pdf">KPMG</a>. This report described the history of taxation of beer and how it has changed over time. It also explained the profit gathered, jobs created and product produced. In depth description of the specific types of taxes are also described.</li>
<li>The <a href="https://www.nbwa.org/government/state-policy-issues">American’s Beer Distributor</a> has a great compilation of all types of laws that affect how beer is taxed. This summary gives a great overview at all the moving parts of taxation as well as additional sources to learn more. This source was also where we got more data.</li>
<li>One type of taxation is <a href="https://www.nbwa.org/government/benefits-of-beer-franchise-laws">Beer franchise law</a>. These laws help local brewers can be competitive in the marketplace. Although there are a lot of nuances behind these laws they are in place to help consumers be able to have lots of choices and breweries have access to ways to promote themselves. This inpacks our analysis because through all the different ways breweries are tax really influence the tax rate of the beer and the cumulative tax growth per year.</li>
<li>Another great documentation of state taxation laws is collected on the <a href="https://www.ncsla.org/State-Officials.html">NCSLA webpage</a>. This webpage split the states up into two type of taxation laws, License Jurisdiction and Control Jurisdiction. There two different types of government power influence how breweries operate and how taxation happens. This webpage and further description on each state inspired our Analysis page. Please go to that page to read more about our search to see if these two types of Jurisdictions influence taxation between states.</li>
<li>The <a href="https://www.alcohollawreview.com/category/alcohol-regulation/">Alcohol Law Review</a> has an up to date complication of all the new laws that are being passed about alcohol. This can be anything from taxation to how alcohol can be shipped to consumption laws. It is also a historial bank of all alcohol related laws.</li>
</ul>
</div>
<div id="initial-questions" class="section level3">
<h3>Initial questions:</h3>
<ul>
<li>How much profit and product does each state in the US make each year?</li>
<li>How does the tax rate change over time per state? Which state gives more beer tax? Any trends?</li>
<li>What category/brewer/style of beer has the most Alcohol by volume (ABV)?</li>
<li>Map location of each US brewer with interactive label showing category/style, size of marker showing ABV.</li>
</ul>
<p>What questions are you trying to answer? How did these questions evolve over the course of the project? What new questions did you consider in the course of your analysis? Discuss this in the meeting.</p>
<ul>
<li>What is the cumulative/average taxation over time in each state?</li>
<li>What is the beer consumption per capita over time in each state?</li>
<li>Where are all the US breweries located?</li>
<li>What is the average alcohol by volume (ABV) in each state?</li>
<li>What is the common beer style in each state?</li>
<li>What is the top 8 beer style?</li>
<li>What is the number of barrels/cans and bottles of beer produced by each state?</li>
<li>What is the amount of shipments made of malt beverages?</li>
<li>Is there a difference in tax/cumulative tax/tax per barrel between the two jurisdiction groups?</li>
<li>Is there a linear relationship between taxation and jurisdiction group, year, shipments, population, and consumption?</li>
</ul>
</div>
<div id="data-source-scraping-method-cleaning" class="section level3">
<h3>Data: source, scraping method, cleaning</h3>
<ul>
<li>Dataset 1</li>
</ul>
<p>Yearly Statistical Beer Data by State (2008 – 2019) from <a href="https://www.ttb.gov/beer/statistics">Alcohol and Tobacco Tax and Trade Bureau</a>. This aggregated data contained records on Tax Determined, Taxable Volume of Bottles and Cans, Taxable Volume of Barrels and Kegs each year for each state in barrels.</p>
<pre class="r"><code>#install.packages(&quot;gdata&quot;)
site1 = &quot;http://www.ttb.gov/images/pdfs/statistics/aggregated/aggr-data-beer_2008-2019.xlsx&quot;

#Tax Determined (in Barrels)
tax_df  =  
  gdata::read.xls(site1, sheet = 1, header = T, skip = 6, nrow = 52) %&gt;% #skip note
  janitor::clean_names() %&gt;%
  select(1:13) %&gt;%
  as_tibble() %&gt;%
  rename_with( ~ sub(&quot;x&quot;, &quot;&quot;, .x)) %&gt;% # rename column names
  mutate(state = factor(state)) %&gt;% #state as factor
  mutate_at(vars(2:13), ~ gsub(&quot;,&quot;, &quot;&quot;, .x)) %&gt;% #remove &quot;,&quot; in tax values
  mutate_at(vars(2:13), as.numeric) # tax values as numeric

# Taxable Volume of Bottles and Cans* (in Barrels)
taxable_cans_df  = 
  gdata::read.xls(site1, sheet = 2, header = T, skip = 4, nrow = 52) %&gt;% 
  janitor::clean_names() %&gt;%
  select(1:13) %&gt;%
  as_tibble() %&gt;%
  rename_with( ~ sub(&quot;x&quot;, &quot;&quot;, .x)) %&gt;%
  mutate(state = factor(state)) %&gt;%
  mutate_at(vars(2:13), ~ gsub(&quot;,&quot;, &quot;&quot;, .x)) %&gt;%
  mutate_at(vars(2:13), as.numeric)

# Taxable Volume of Barrels and Kegs*
taxable_barrels_df  = 
  gdata::read.xls(site1, sheet = 3, header = T, skip = 4, nrow = 52) %&gt;% 
  janitor::clean_names() %&gt;%
  select(1:13) %&gt;%
  as_tibble() %&gt;%
  rename_with( ~ sub(&quot;x&quot;, &quot;&quot;, .x)) %&gt;%
  mutate(state = factor(state)) %&gt;%
  mutate_at(vars(2:13), ~ gsub(&quot;,&quot;, &quot;&quot;, .x)) %&gt;%
  mutate_at(vars(2:13), as.numeric)

head(tax_df)</code></pre>
<pre><code>## # A tibble: 6 x 13
##   state `2008` `2009` `2010` `2011` `2012` `2013` `2014` `2015` `2016` `2017`
##   &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 AK     2068.  2264.  1929.  2251. 2.31e3  2156.  2115. 4.51e3 1.33e4 1.60e4
## 2 AL      724.   239.   161.     0  4.65e1   131.   226. 6.11e3 2.38e4 2.92e4
## 3 AR     1328.  1279.  1332.  1125. 1.27e3   558.   657. 1.61e3 6.09e3 1.34e4
## 4 AZ    14858. 15641. 16800. 19898. 1.92e4 18764. 17173  2.99e4 4.16e4 4.54e4
## 5 CA    61173. 54505. 58276. 65070. 6.42e4 60560. 65035. 1.25e5 2.01e5 2.94e5
## 6 CO    48529. 49896. 50585. 60811. 5.80e4 60133. 72839. 1.22e5 1.41e5 1.63e5
## # … with 2 more variables: `2018` &lt;dbl&gt;, `2019` &lt;dbl&gt;</code></pre>
<pre class="r"><code>head(taxable_cans_df)</code></pre>
<pre><code>## # A tibble: 6 x 13
##   state  `2008`  `2009`  `2010` `2011` `2012` `2013` `2014` `2015` `2016` `2017`
##   &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 AK     8.12e4  8.98e4  8.09e4 9.48e4 1.05e5 1.12e5 1.29e5 1.26e5 1.16e5 1.10e5
## 2 AL    NA      NA      NA      6.59e2 2.49e3 6.63e3 9.52e3 1.05e4 9.98e3 1.18e4
## 3 AR     1.21e3  1.27e3  1.45e3 1.38e3 8.00e0 8.00e0 8.00e2 8.72e2 1.74e3 8.72e3
## 4 AZ     6.98e3  7.38e3  1.04e4 1.41e4 1.84e4 2.23e4 2.96e4 4.40e4 5.90e4 6.65e4
## 5 CA     2.01e7  1.95e7  1.91e7 1.82e7 1.89e7 1.78e7 1.81e7 1.77e7 1.76e7 1.67e7
## 6 CO     2.42e7  2.11e7  1.87e7 1.88e7 1.93e7 1.85e7 1.80e7 1.78e7 1.81e7 1.80e7
## # … with 2 more variables: `2018` &lt;dbl&gt;, `2019` &lt;dbl&gt;</code></pre>
<pre class="r"><code>head(taxable_barrels_df)</code></pre>
<pre><code>## # A tibble: 6 x 13
##   state `2008` `2009` `2010` `2011` `2012` `2013` `2014` `2015` `2016` `2017`
##   &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 AK    5.09e4 5.23e4 5.44e4 5.85e4 6.57e4 6.89e4 7.38e4 7.46e4 6.95e4 6.62e4
## 2 AL    1.57e2 4.60e2 5.48e2 1.81e3 6.45e3 1.17e4 1.37e4 1.15e4 1.18e4 8.77e3
## 3 AR    8.83e2 1.08e3 1.32e3 1.14e3 1.26e2 1.08e3 2.79e3 6.97e3 9.06e3 4.82e3
## 4 AZ    1.86e4 1.83e4 2.44e4 3.28e4 4.48e4 5.91e4 8.02e4 7.50e4 7.19e4 7.05e4
## 5 CA    2.01e6 2.07e6 2.20e6 2.17e6 2.27e6 2.39e6 2.33e6 2.22e6 2.17e6 2.18e6
## 6 CO    2.56e6 2.29e6 2.28e6 2.28e6 2.29e6 2.18e6 2.21e6 2.08e6 1.90e6 1.56e6
## # … with 2 more variables: `2018` &lt;dbl&gt;, `2019` &lt;dbl&gt;</code></pre>
<pre class="r"><code># write_csv(tax_df, &quot;data_import_cleaning/tax.csv&quot;)
# write_csv(taxable_cans_df, &quot;data_import_cleaning/tax_cans.csv&quot;)
# write_csv(taxable_barrels_df, &quot;data_import_cleaning/tax_barrels_df.csv&quot;)</code></pre>
<ul>
<li>Dataset 2</li>
</ul>
<p>Open Beer database from <a href="https://data.opendatasoft.com/explore/dataset/open-beer-database%40public-us/information/?rows=4588&amp;timezone=&amp;refine.country=United+States&amp;location=2,16.98232,9.498&amp;basemap=jawg.sunny&amp;dataChart=eyJxdWVyaWVzIjpbeyJjb25maWciOnsiZGF0YXNldCI6Im9wZW4tYmVlci1kYXRhYmFzZUBwdWJsaWMtdXMiLCJvcHRpb25zIjp7fX0sImNoYXJ0cyI6W3siYWxpZ25Nb250aCI6dHJ1ZSwidHlwZSI6ImxpbmUiLCJmdW5jIjoiQVZHIiwieUF4aXMiOiJhYnYiLCJzY2llbnRpZmljRGlzcGxheSI6dHJ1ZSwiY29sb3IiOiIjMTQyRTdCIn1dLCJ4QXhpcyI6Imxhc3RfbW9kIiwibWF4cG9pbnRzIjoiIiwidGltZXNjYWxlIjoieWVhciIsInNvcnQiOiIifV0sImRpc3BsYXlMZWdlbmQiOnRydWUsImFsaWduTW9udGgiOnRydWV9">Opendatasoft</a>. This dataset contains information of each beer product, including product name, universal product code, style, category, brewer along with its address and website, percentage of alcohol by volume, bitterness from hops in a beer, beer color, and description in text.</p>
<pre class="r"><code>beer_specific = 
  read_delim(&quot;https://public-us.opendatasoft.com/explore/dataset/open-beer-database/download/?format=csv&amp;timezone=America/New_York&amp;lang=en&amp;use_labels_for_header=true&amp;csv_separator=%3B&quot;, delim = &quot;;&quot;) %&gt;% # sep = &quot;;&quot;
  janitor::clean_names() %&gt;%
  filter(country == &quot;United States&quot;) %&gt;% # only investigate beer in US
  separate(coordinates, c(&quot;latitude&quot;, &quot;longitude&quot;), sep = &quot;,&quot;) # separate geographic info

head(beer_specific)</code></pre>
<pre><code>## # A tibble: 6 x 23
##   name  id    brewery_id cat_id style_id alcohol_by_volu… international_b…
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;            &lt;dbl&gt;
## 1 Port… 716   842             2 25                   0                   0
## 2 Poss… 723   445             2 25                   5.60                0
## 3 Fire… 754   504             3 33                   0                   0
## 4 Maib… 736   1124            7 90                   0                   0
## 5 Buzz… 2079  809             3 26                   0                   0
## 6 Free… 742   1151            3 33                   4.5                 0
## # … with 16 more variables: standard_reference_method &lt;dbl&gt;,
## #   universal_product_code &lt;dbl&gt;, filepath &lt;chr&gt;, description &lt;chr&gt;,
## #   add_user &lt;chr&gt;, last_mod &lt;dttm&gt;, style &lt;chr&gt;, category &lt;chr&gt;, brewer &lt;chr&gt;,
## #   address &lt;chr&gt;, city &lt;chr&gt;, state &lt;chr&gt;, country &lt;chr&gt;, latitude &lt;chr&gt;,
## #   longitude &lt;chr&gt;, website &lt;chr&gt;</code></pre>
<pre class="r"><code># write_csv(beer_specific, &quot;data_import_cleaning/beer.csv&quot;)</code></pre>
<ul>
<li>Dataset 3 – Amy? Amy, please add your data source, scraping method and cleaning, code and comment.</li>
</ul>
</div>
<div id="exploratory-analysis" class="section level3">
<h3>Exploratory analysis:</h3>
<p>Visualizations, summaries, and exploratory statistical analyses. Justify the steps you took, and show any major changes to your ideas. Each of us add our part, should include code that can generate the plot(please note file path), comment on the plots and answer the above corresponding initial questions part. I will try to revise them in a reasonable order.</p>
<div id="amy" class="section level4">
<h4>Amy:</h4>
</div>
<div id="ruiyang" class="section level4">
<h4>Ruiyang:</h4>
<p><strong>Alcohol by volume (ABV)</strong> is defined to be the volume percent of alcohol (ethanol) contained in a given volume of an alcoholic beverage. In our project, we are interested in exploring the pattern of ABV concerning the category/brewer/style of beer (initial question 3).</p>
<p><strong>By category</strong></p>
<p>First, we looked at the pattern of ABV by beer’s category.</p>
<ul>
<li>Based on our dataset, <strong>Belgian and French Ale</strong> has the <strong>highest</strong> average ABV while the <strong>North American Lager</strong> has the <strong>lowest</strong> average ABV.</li>
</ul>
<pre class="r"><code>beer = read_csv(&quot;./data_import_cleaning/beer.csv&quot;)

cat_abv = 
  beer %&gt;% 
  replace_na(list(category = &quot;NA&quot;, y = &quot;unknown&quot;)) %&gt;% 
  group_by(category) %&gt;% 
  summarise(mean_abv = mean(alcohol_by_volume)) %&gt;% 
  arrange(desc(mean_abv)) 
cat_abv
## # A tibble: 9 x 2
##   category               mean_abv
##   &lt;chr&gt;                     &lt;dbl&gt;
## 1 Belgian and French Ale     6.50
## 2 British Ale                4.40
## 3 Other Style                3.82
## 4 North American Ale         3.40
## 5 German Lager               2.96
## 6 German Ale                 2.67
## 7 Irish Ale                  2.39
## 8 NA                         2.38
## 9 North American Lager       1.75
cat_abv %&gt;% 
  mutate(category = fct_reorder(category, mean_abv)) %&gt;% 
  plot_ly(x = ~category, y = ~mean_abv, 
          color = ~category, type = &quot;bar&quot;, colors = &quot;viridis&quot;) %&gt;% 
  layout(title = &quot;Average ABV by Beer Category&quot;,
         xaxis = list(title = &quot;Beer Category&quot;,
                      zeroline = TRUE),
         yaxis = list(title = &quot;Average ABV&quot;,
                      range = c(0, 7)))</code></pre>
<div id="htmlwidget-00aaa6cac05cab962c69" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-00aaa6cac05cab962c69">{"x":{"visdat":{"3cc580925e1":["function () ","plotlyVisDat"]},"cur_data":"3cc580925e1","attrs":{"3cc580925e1":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average ABV by Beer Category","xaxis":{"domain":[0,1],"automargin":true,"title":"Beer Category","zeroline":true,"type":"category","categoryorder":"array","categoryarray":["North American Lager","NA","Irish Ale","German Ale","German Lager","North American Ale","Other Style","British Ale","Belgian and French Ale"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average ABV","range":[0,7]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["North American Lager"],"y":[1.74905092352014],"type":"bar","name":"North American Lager","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["NA"],"y":[2.37783333751711],"type":"bar","name":"NA","marker":{"color":"rgba(71,45,123,1)","line":{"color":"rgba(71,45,123,1)"}},"textfont":{"color":"rgba(71,45,123,1)"},"error_y":{"color":"rgba(71,45,123,1)"},"error_x":{"color":"rgba(71,45,123,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Irish Ale"],"y":[2.38843137236157],"type":"bar","name":"Irish Ale","marker":{"color":"rgba(59,82,139,1)","line":{"color":"rgba(59,82,139,1)"}},"textfont":{"color":"rgba(59,82,139,1)"},"error_y":{"color":"rgba(59,82,139,1)"},"error_x":{"color":"rgba(59,82,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["German Ale"],"y":[2.66887416271258],"type":"bar","name":"German Ale","marker":{"color":"rgba(44,114,142,1)","line":{"color":"rgba(44,114,142,1)"}},"textfont":{"color":"rgba(44,114,142,1)"},"error_y":{"color":"rgba(44,114,142,1)"},"error_x":{"color":"rgba(44,114,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["German Lager"],"y":[2.96063091627066],"type":"bar","name":"German Lager","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,1)"},"error_y":{"color":"rgba(33,144,141,1)"},"error_x":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["North American Ale"],"y":[3.40105119912369],"type":"bar","name":"North American Ale","marker":{"color":"rgba(39,173,129,1)","line":{"color":"rgba(39,173,129,1)"}},"textfont":{"color":"rgba(39,173,129,1)"},"error_y":{"color":"rgba(39,173,129,1)"},"error_x":{"color":"rgba(39,173,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Other Style"],"y":[3.82319501821494],"type":"bar","name":"Other Style","marker":{"color":"rgba(93,200,99,1)","line":{"color":"rgba(93,200,99,1)"}},"textfont":{"color":"rgba(93,200,99,1)"},"error_y":{"color":"rgba(93,200,99,1)"},"error_x":{"color":"rgba(93,200,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["British Ale"],"y":[4.39871368764357],"type":"bar","name":"British Ale","marker":{"color":"rgba(170,220,50,1)","line":{"color":"rgba(170,220,50,1)"}},"textfont":{"color":"rgba(170,220,50,1)"},"error_y":{"color":"rgba(170,220,50,1)"},"error_x":{"color":"rgba(170,220,50,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Belgian and French Ale"],"y":[6.49562791336512],"type":"bar","name":"Belgian and French Ale","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>By brewer</strong></p>
<p>Next, we looked at the pattern of ABV by beer’s brewer.</p>
<p>As there are 823 brewers listed in our dataset, we will show the <strong>top 20</strong> that has the highest average ABV, rather than all of them.</p>
<ul>
<li><strong>Mendocino Brewing - Ukiah</strong> has the highest average ABV.</li>
<li>There are 424 brewers having average ABV value of 0.</li>
</ul>
<pre class="r"><code>brewer_abv = 
  beer %&gt;% 
  group_by(brewer) %&gt;% 
  summarise(mean_abv = mean(alcohol_by_volume)) %&gt;% 
  arrange(desc(mean_abv))
brewer_abv
## # A tibble: 823 x 2
##    brewer                        mean_abv
##    &lt;chr&gt;                            &lt;dbl&gt;
##  1 Mendocino Brewing - Ukiah        10.5 
##  2 Avery Brewing Company            10.5 
##  3 Foothills Brewing Company        10   
##  4 Dogfish Head Craft Brewery        9.78
##  5 Voodoo Brewing Co.,LLC            9.60
##  6 High Point Wheat Beer Company     9.5 
##  7 Brewery Vivant                    9.25
##  8 Oso                               9.20
##  9 Oregon Trail Brewery              9.10
## 10 Independence Brewing Co           9   
## # … with 813 more rows

#brewer_abv %&gt;% filter(mean_abv == 0) #424

brewer_abv %&gt;% 
  slice(1:20) %&gt;% 
  mutate(brewer = fct_reorder(brewer, mean_abv)) %&gt;%
  plot_ly(x = ~brewer, y = ~mean_abv, 
          color = ~brewer, type = &quot;bar&quot;, colors = &quot;viridis&quot;) %&gt;%
  layout(title = &quot;Average ABV by Beer Brewer&quot;,
         xaxis = list(title = &quot;Beer Brewer&quot;,
                      zeroline = TRUE),
         yaxis = list(title = &quot;Average ABV&quot;,
                      range = c(8, 10.8)))</code></pre>
<div id="htmlwidget-6e2e8a276ab5f7f1c2c1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6e2e8a276ab5f7f1c2c1">{"x":{"visdat":{"3cc55e563a8b":["function () ","plotlyVisDat"]},"cur_data":"3cc55e563a8b","attrs":{"3cc55e563a8b":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average ABV by Beer Brewer","xaxis":{"domain":[0,1],"automargin":true,"title":"Beer Brewer","zeroline":true,"type":"category","categoryorder":"array","categoryarray":["CJ's Brewery & Grill","Weyerbacher Brewing Company","Cat's Paw Home Brew","Gordash Brewing Company","Ukiah Brewing","Founders Brewing","Portsmouth Brewery","Amicas Pizza, Microbrews and More","The Lost Abbey","Element Brewing Company","Independence Brewing Co","Oregon Trail Brewery","Oso","Brewery Vivant","High Point Wheat Beer Company","Voodoo Brewing Co.,LLC","Dogfish Head Craft Brewery","Foothills Brewing Company","Avery Brewing Company","Mendocino Brewing - Ukiah"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average ABV","range":[8,10.8]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["CJ's Brewery & Grill"],"y":[8.1000003815],"type":"bar","name":"CJ's Brewery & Grill","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Weyerbacher Brewing Company"],"y":[8.13000001904333],"type":"bar","name":"Weyerbacher Brewing Company","marker":{"color":"rgba(72,21,103,1)","line":{"color":"rgba(72,21,103,1)"}},"textfont":{"color":"rgba(72,21,103,1)"},"error_y":{"color":"rgba(72,21,103,1)"},"error_x":{"color":"rgba(72,21,103,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Cat's Paw Home Brew"],"y":[8.1999998093],"type":"bar","name":"Cat's Paw Home Brew","marker":{"color":"rgba(72,38,119,1)","line":{"color":"rgba(72,38,119,1)"}},"textfont":{"color":"rgba(72,38,119,1)"},"error_y":{"color":"rgba(72,38,119,1)"},"error_x":{"color":"rgba(72,38,119,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Gordash Brewing Company"],"y":[8.25],"type":"bar","name":"Gordash Brewing Company","marker":{"color":"rgba(69,55,129,1)","line":{"color":"rgba(69,55,129,1)"}},"textfont":{"color":"rgba(69,55,129,1)"},"error_y":{"color":"rgba(69,55,129,1)"},"error_x":{"color":"rgba(69,55,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Ukiah Brewing"],"y":[8.3000001907],"type":"bar","name":"Ukiah Brewing","marker":{"color":"rgba(63,71,136,1)","line":{"color":"rgba(63,71,136,1)"}},"textfont":{"color":"rgba(63,71,136,1)"},"error_y":{"color":"rgba(63,71,136,1)"},"error_x":{"color":"rgba(63,71,136,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Founders Brewing"],"y":[8.3285713877],"type":"bar","name":"Founders Brewing","marker":{"color":"rgba(57,85,140,1)","line":{"color":"rgba(57,85,140,1)"}},"textfont":{"color":"rgba(57,85,140,1)"},"error_y":{"color":"rgba(57,85,140,1)"},"error_x":{"color":"rgba(57,85,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Portsmouth Brewery"],"y":[8.5],"type":"bar","name":"Portsmouth Brewery","marker":{"color":"rgba(50,100,142,1)","line":{"color":"rgba(50,100,142,1)"}},"textfont":{"color":"rgba(50,100,142,1)"},"error_y":{"color":"rgba(50,100,142,1)"},"error_x":{"color":"rgba(50,100,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Amicas Pizza, Microbrews and More"],"y":[8.6000003815],"type":"bar","name":"Amicas Pizza, Microbrews and More","marker":{"color":"rgba(45,113,142,1)","line":{"color":"rgba(45,113,142,1)"}},"textfont":{"color":"rgba(45,113,142,1)"},"error_y":{"color":"rgba(45,113,142,1)"},"error_x":{"color":"rgba(45,113,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["The Lost Abbey"],"y":[8.7071428299],"type":"bar","name":"The Lost Abbey","marker":{"color":"rgba(40,125,142,1)","line":{"color":"rgba(40,125,142,1)"}},"textfont":{"color":"rgba(40,125,142,1)"},"error_y":{"color":"rgba(40,125,142,1)"},"error_x":{"color":"rgba(40,125,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Element Brewing Company"],"y":[8.75],"type":"bar","name":"Element Brewing Company","marker":{"color":"rgba(35,138,141,1)","line":{"color":"rgba(35,138,141,1)"}},"textfont":{"color":"rgba(35,138,141,1)"},"error_y":{"color":"rgba(35,138,141,1)"},"error_x":{"color":"rgba(35,138,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Independence Brewing Co"],"y":[9],"type":"bar","name":"Independence Brewing Co","marker":{"color":"rgba(31,150,139,1)","line":{"color":"rgba(31,150,139,1)"}},"textfont":{"color":"rgba(31,150,139,1)"},"error_y":{"color":"rgba(31,150,139,1)"},"error_x":{"color":"rgba(31,150,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oregon Trail Brewery"],"y":[9.1000003815],"type":"bar","name":"Oregon Trail Brewery","marker":{"color":"rgba(32,163,134,1)","line":{"color":"rgba(32,163,134,1)"}},"textfont":{"color":"rgba(32,163,134,1)"},"error_y":{"color":"rgba(32,163,134,1)"},"error_x":{"color":"rgba(32,163,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Oso"],"y":[9.1999998093],"type":"bar","name":"Oso","marker":{"color":"rgba(41,175,127,1)","line":{"color":"rgba(41,175,127,1)"}},"textfont":{"color":"rgba(41,175,127,1)"},"error_y":{"color":"rgba(41,175,127,1)"},"error_x":{"color":"rgba(41,175,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Brewery Vivant"],"y":[9.25],"type":"bar","name":"Brewery Vivant","marker":{"color":"rgba(60,187,117,1)","line":{"color":"rgba(60,187,117,1)"}},"textfont":{"color":"rgba(60,187,117,1)"},"error_y":{"color":"rgba(60,187,117,1)"},"error_x":{"color":"rgba(60,187,117,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["High Point Wheat Beer Company"],"y":[9.5],"type":"bar","name":"High Point Wheat Beer Company","marker":{"color":"rgba(86,198,103,1)","line":{"color":"rgba(86,198,103,1)"}},"textfont":{"color":"rgba(86,198,103,1)"},"error_y":{"color":"rgba(86,198,103,1)"},"error_x":{"color":"rgba(86,198,103,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Voodoo Brewing Co.,LLC"],"y":[9.6000000238375],"type":"bar","name":"Voodoo Brewing Co.,LLC","marker":{"color":"rgba(116,208,85,1)","line":{"color":"rgba(116,208,85,1)"}},"textfont":{"color":"rgba(116,208,85,1)"},"error_y":{"color":"rgba(116,208,85,1)"},"error_x":{"color":"rgba(116,208,85,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Dogfish Head Craft Brewery"],"y":[9.77555554002222],"type":"bar","name":"Dogfish Head Craft Brewery","marker":{"color":"rgba(148,216,64,1)","line":{"color":"rgba(148,216,64,1)"}},"textfont":{"color":"rgba(148,216,64,1)"},"error_y":{"color":"rgba(148,216,64,1)"},"error_x":{"color":"rgba(148,216,64,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Foothills Brewing Company"],"y":[10],"type":"bar","name":"Foothills Brewing Company","marker":{"color":"rgba(184,222,41,1)","line":{"color":"rgba(184,222,41,1)"}},"textfont":{"color":"rgba(184,222,41,1)"},"error_y":{"color":"rgba(184,222,41,1)"},"error_x":{"color":"rgba(184,222,41,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Avery Brewing Company"],"y":[10.4569230447462],"type":"bar","name":"Avery Brewing Company","marker":{"color":"rgba(220,227,24,1)","line":{"color":"rgba(220,227,24,1)"}},"textfont":{"color":"rgba(220,227,24,1)"},"error_y":{"color":"rgba(220,227,24,1)"},"error_x":{"color":"rgba(220,227,24,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mendocino Brewing - Ukiah"],"y":[10.5],"type":"bar","name":"Mendocino Brewing - Ukiah","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><strong>By style</strong></p>
<p>Finally, we looked at the pattern of ABV by beer’s style.</p>
<p>There are 62 styles listed in our dataset, and we will show the <strong>top 20</strong> that has the highest average ABV, as well as the <strong>lowest 5</strong>.</p>
<ul>
<li>We can see that <strong>Belgian-Style Quadrupel</strong> has the higherst average ABV while both <strong>Vienna-Style Lager</strong> and <strong>Specialty Honey Lager or Ale</strong> has average ABV of 0.</li>
</ul>
<pre class="r"><code>style_abv = 
  beer %&gt;% 
  group_by(style) %&gt;% 
  summarise(mean_abv = mean(alcohol_by_volume)) %&gt;% 
  arrange(desc(mean_abv))
style_abv
## # A tibble: 62 x 2
##    style                             mean_abv
##    &lt;chr&gt;                                &lt;dbl&gt;
##  1 Belgian-Style Quadrupel              11.7 
##  2 Strong Ale                           11.2 
##  3 American-Style Barley Wine Ale        9.96
##  4 American-Style Imperial Stout         9.77
##  5 Belgian-Style Dark Strong Ale         9.67
##  6 Imperial or Double Red Ale            9.20
##  7 Specialty Beer                        8.75
##  8 American-Style India Black Ale        8.70
##  9 Belgian-Style Pale Strong Ale         8.63
## 10 Imperial or Double India Pale Ale     8.58
## # … with 52 more rows

style_abv %&gt;% 
  slice(1:20) %&gt;% 
  mutate(style = fct_reorder(style, mean_abv)) %&gt;% 
  plot_ly(x = ~style, y = ~mean_abv, 
          color = ~style, type = &quot;bar&quot;, colors = &quot;viridis&quot;)  %&gt;%
  layout(title = &quot;Average ABV by Beer Style&quot;,
         xaxis = list(title = &quot;Beer Style&quot;,
                      zeroline = TRUE),
         yaxis = list(title = &quot;Average ABV&quot;,
                      range = c(5.5, 12)))</code></pre>
<div id="htmlwidget-13e520f2e6e36b269238" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-13e520f2e6e36b269238">{"x":{"visdat":{"3cc550b45c7":["function () ","plotlyVisDat"]},"cur_data":"3cc550b45c7","attrs":{"3cc550b45c7":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average ABV by Beer Style","xaxis":{"domain":[0,1],"automargin":true,"title":"Beer Style","zeroline":true,"type":"category","categoryorder":"array","categoryarray":["South German-Style Weizenbock","Winter Warmer","Herb and Spice Beer","Pumpkin Beer","Other Belgian-Style Ales","German-Style Doppelbock","Belgian-Style Dubbel","Dark American-Belgo-Style Ale","American-Style Strong Pale Ale","Belgian-Style Tripel","Imperial or Double India Pale Ale","Belgian-Style Pale Strong Ale","American-Style India Black Ale","Specialty Beer","Imperial or Double Red Ale","Belgian-Style Dark Strong Ale","American-Style Imperial Stout","American-Style Barley Wine Ale","Strong Ale","Belgian-Style Quadrupel"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average ABV","range":[5.5,12]},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["South German-Style Weizenbock"],"y":[6.09166661899167],"type":"bar","name":"South German-Style Weizenbock","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Winter Warmer"],"y":[6.27333336784762],"type":"bar","name":"Winter Warmer","marker":{"color":"rgba(72,21,103,1)","line":{"color":"rgba(72,21,103,1)"}},"textfont":{"color":"rgba(72,21,103,1)"},"error_y":{"color":"rgba(72,21,103,1)"},"error_x":{"color":"rgba(72,21,103,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Herb and Spice Beer"],"y":[6.4375000596],"type":"bar","name":"Herb and Spice Beer","marker":{"color":"rgba(72,38,119,1)","line":{"color":"rgba(72,38,119,1)"}},"textfont":{"color":"rgba(72,38,119,1)"},"error_y":{"color":"rgba(72,38,119,1)"},"error_x":{"color":"rgba(72,38,119,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Pumpkin Beer"],"y":[6.71176467222353],"type":"bar","name":"Pumpkin Beer","marker":{"color":"rgba(69,55,129,1)","line":{"color":"rgba(69,55,129,1)"}},"textfont":{"color":"rgba(69,55,129,1)"},"error_y":{"color":"rgba(69,55,129,1)"},"error_x":{"color":"rgba(69,55,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Other Belgian-Style Ales"],"y":[6.737000017162],"type":"bar","name":"Other Belgian-Style Ales","marker":{"color":"rgba(63,71,136,1)","line":{"color":"rgba(63,71,136,1)"}},"textfont":{"color":"rgba(63,71,136,1)"},"error_y":{"color":"rgba(63,71,136,1)"},"error_x":{"color":"rgba(63,71,136,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["German-Style Doppelbock"],"y":[6.79062494635625],"type":"bar","name":"German-Style Doppelbock","marker":{"color":"rgba(57,85,140,1)","line":{"color":"rgba(57,85,140,1)"}},"textfont":{"color":"rgba(57,85,140,1)"},"error_y":{"color":"rgba(57,85,140,1)"},"error_x":{"color":"rgba(57,85,140,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Belgian-Style Dubbel"],"y":[6.91999998093],"type":"bar","name":"Belgian-Style Dubbel","marker":{"color":"rgba(50,100,142,1)","line":{"color":"rgba(50,100,142,1)"}},"textfont":{"color":"rgba(50,100,142,1)"},"error_y":{"color":"rgba(50,100,142,1)"},"error_x":{"color":"rgba(50,100,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Dark American-Belgo-Style Ale"],"y":[7.891666650775],"type":"bar","name":"Dark American-Belgo-Style Ale","marker":{"color":"rgba(45,113,142,1)","line":{"color":"rgba(45,113,142,1)"}},"textfont":{"color":"rgba(45,113,142,1)"},"error_y":{"color":"rgba(45,113,142,1)"},"error_x":{"color":"rgba(45,113,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American-Style Strong Pale Ale"],"y":[8.40769235903846],"type":"bar","name":"American-Style Strong Pale Ale","marker":{"color":"rgba(40,125,142,1)","line":{"color":"rgba(40,125,142,1)"}},"textfont":{"color":"rgba(40,125,142,1)"},"error_y":{"color":"rgba(40,125,142,1)"},"error_x":{"color":"rgba(40,125,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Belgian-Style Tripel"],"y":[8.44250003990313],"type":"bar","name":"Belgian-Style Tripel","marker":{"color":"rgba(35,138,141,1)","line":{"color":"rgba(35,138,141,1)"}},"textfont":{"color":"rgba(35,138,141,1)"},"error_y":{"color":"rgba(35,138,141,1)"},"error_x":{"color":"rgba(35,138,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Imperial or Double India Pale Ale"],"y":[8.58367346742959],"type":"bar","name":"Imperial or Double India Pale Ale","marker":{"color":"rgba(31,150,139,1)","line":{"color":"rgba(31,150,139,1)"}},"textfont":{"color":"rgba(31,150,139,1)"},"error_y":{"color":"rgba(31,150,139,1)"},"error_x":{"color":"rgba(31,150,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Belgian-Style Pale Strong Ale"],"y":[8.63000001907],"type":"bar","name":"Belgian-Style Pale Strong Ale","marker":{"color":"rgba(32,163,134,1)","line":{"color":"rgba(32,163,134,1)"}},"textfont":{"color":"rgba(32,163,134,1)"},"error_y":{"color":"rgba(32,163,134,1)"},"error_x":{"color":"rgba(32,163,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American-Style India Black Ale"],"y":[8.6999998093],"type":"bar","name":"American-Style India Black Ale","marker":{"color":"rgba(41,175,127,1)","line":{"color":"rgba(41,175,127,1)"}},"textfont":{"color":"rgba(41,175,127,1)"},"error_y":{"color":"rgba(41,175,127,1)"},"error_x":{"color":"rgba(41,175,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Specialty Beer"],"y":[8.75],"type":"bar","name":"Specialty Beer","marker":{"color":"rgba(60,187,117,1)","line":{"color":"rgba(60,187,117,1)"}},"textfont":{"color":"rgba(60,187,117,1)"},"error_y":{"color":"rgba(60,187,117,1)"},"error_x":{"color":"rgba(60,187,117,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Imperial or Double Red Ale"],"y":[9.1999998093],"type":"bar","name":"Imperial or Double Red Ale","marker":{"color":"rgba(86,198,103,1)","line":{"color":"rgba(86,198,103,1)"}},"textfont":{"color":"rgba(86,198,103,1)"},"error_y":{"color":"rgba(86,198,103,1)"},"error_x":{"color":"rgba(86,198,103,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Belgian-Style Dark Strong Ale"],"y":[9.66666656075556],"type":"bar","name":"Belgian-Style Dark Strong Ale","marker":{"color":"rgba(116,208,85,1)","line":{"color":"rgba(116,208,85,1)"}},"textfont":{"color":"rgba(116,208,85,1)"},"error_y":{"color":"rgba(116,208,85,1)"},"error_x":{"color":"rgba(116,208,85,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American-Style Imperial Stout"],"y":[9.76956522292029],"type":"bar","name":"American-Style Imperial Stout","marker":{"color":"rgba(148,216,64,1)","line":{"color":"rgba(148,216,64,1)"}},"textfont":{"color":"rgba(148,216,64,1)"},"error_y":{"color":"rgba(148,216,64,1)"},"error_x":{"color":"rgba(148,216,64,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American-Style Barley Wine Ale"],"y":[9.95631579347632],"type":"bar","name":"American-Style Barley Wine Ale","marker":{"color":"rgba(184,222,41,1)","line":{"color":"rgba(184,222,41,1)"}},"textfont":{"color":"rgba(184,222,41,1)"},"error_y":{"color":"rgba(184,222,41,1)"},"error_x":{"color":"rgba(184,222,41,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Strong Ale"],"y":[11.25],"type":"bar","name":"Strong Ale","marker":{"color":"rgba(220,227,24,1)","line":{"color":"rgba(220,227,24,1)"}},"textfont":{"color":"rgba(220,227,24,1)"},"error_y":{"color":"rgba(220,227,24,1)"},"error_x":{"color":"rgba(220,227,24,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Belgian-Style Quadrupel"],"y":[11.7000000818143],"type":"bar","name":"Belgian-Style Quadrupel","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>
tail(style_abv) %&gt;% 
  rename(Style = style, `Average ABV` = mean_abv) %&gt;% 
  slice(-1) %&gt;% 
  mutate_at(2, round, 2) %&gt;% 
  knitr::kable(caption = &quot;Styles with Lowest 5 Average AVB&quot;) %&gt;% 
  kableExtra::kable_styling(., bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;),
                            full_width = F)</code></pre>
<table class="table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Styles with Lowest 5 Average AVB
</caption>
<thead>
<tr>
<th style="text-align:left;">
Style
</th>
<th style="text-align:right;">
Average ABV
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
American-Style Lager
</td>
<td style="text-align:right;">
1.53
</td>
</tr>
<tr>
<td style="text-align:left;">
English-Style Pale Mild Ale
</td>
<td style="text-align:right;">
0.68
</td>
</tr>
<tr>
<td style="text-align:left;">
Out of Category
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Specialty Honey Lager or Ale
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Vienna-Style Lager
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
</table>
</div>
<div id="wenbo" class="section level4">
<h4>Wenbo:</h4>
</div>
<div id="iris" class="section level4">
<h4>Iris:</h4>
</div>
</div>
<div id="additional-analysis-regression-ruiyang" class="section level3">
<h3>Additional analysis: Regression – Ruiyang?</h3>
<p>If you undertake formal statistical analyses, describe these in detail</p>
<p>[starts here]</p>
<p>We focus on two analyses in our project. One is to compare tax differences by jurisdiction group over time. The other is to model taxation under the regression analysis framework. More details can be found in the Analysis section on our website (link to be inserted here).</p>
<p><strong>1. Preliminary Analysis</strong> – Tax differences by jurisdiction group</p>
<p><strong>Motivation</strong></p>
<p>Differing on the degree of control on liquor wholesales and retail, states can be categorized into two <a href="https://www.ncsla.org/State-Officials.html">types</a> – control jurisdiction and licensed jurisdiction, with licensed states having more control. Such categorization may lead to difference in taxation. Therefore, we are interested in examining if there is any difference in taxation by these two groups of states.</p>
<p><strong>Procedures</strong></p>
<p>We performed t-test for each year from 2010 to 2019 and would like to see if there is any significant difference in the cumulative tax between control states and licensed states.</p>
<p><strong>Findings</strong></p>
<p>Based on the test results, however, we did not find sufficient evidence showing any significant difference between two jurisdiction groups in both the cumulative tax collected and the tax per barrel from 2010 to 2019.</p>
<p>We speculated that there may be some confounding variables that could potentially affect the relationship between taxation and the jurisdiction group. Therefore, we decided to further perform regression analysis. Specifically, we would like to explore more regarding the relationship between taxation and jurisdiction group, year, shipments, population, and consumption.</p>
<p><strong>2. Regression Analysis</strong></p>
<p><strong>Variables of interest</strong></p>
<p>Our explaining variables of interest include jurisdiction group, year, shipments, population, and consumption. Their detailed explanation are as below.</p>
<ul>
<li>group: jurisdiction group (control vs licensed)</li>
<li>shipments: amount of barrels shipped</li>
<li>population: the number of individuals who are 21 years old or older</li>
<li>consumption: consumption of barrels per capital</li>
</ul>
<p><strong>Model</strong></p>
<p>Our intended model is</p>
<p><span class="math display">\[Tax = \beta_0 + \beta_1 \ Group + \beta_2 Year + \beta_3 \ Shipments + \beta_4 \ Population+ \beta_5 \ Consumption\]</span></p>
<p>We looked at both the cumulative tax collected and the tax per barrel.</p>
<p><strong>Results &amp; Findings</strong></p>
<p>In the model of the <strong>tax per barrel</strong>, all the variables are <strong>not significant</strong> at the 5% significance level; further the model is poorly fitted as the adjusted <span class="math inline">\(R^2\)</span> is approximately 0. Therefore, we will mostly focus on the cumulative tax collected.</p>
<p>In the model of <strong>cumulative tax collected</strong>, we found that:</p>
<ul>
<li>All variables in our model are <strong>significant</strong> at the 5% significance level.</li>
<li>Our model fit is acceptable with an adjusted <span class="math inline">\(R^2 = 0.55\)</span>.</li>
<li>Previously, we did not find any significant difference in the cumulative tax between two jurisdiction groups. However, after controlling for year, shipments, population and consumption, we found that <strong>licensed states</strong> are estimated to have approximately <strong>7.5k less cumulative tax collected</strong> than the control states.</li>
<li><strong>Cumulative tax collected</strong> is estimate to <strong>increase approximately 7k per year</strong>, holding the group, shipments, population and consumption unchanged.</li>
<li>Cumulative tax collected is estimated to <strong>increase approximately 1k for one unit increase in consumption per capital</strong>, holding the group, year, shipments, and population unchanged.</li>
<li>Population and shipments have estimated coefficients close to 0, though they have significant p-values.</li>
</ul>
<pre class="r"><code># Load datasets
state_df = read_csv(&quot;data_import_cleaning/state_df.csv&quot;)
tax_df = read_csv( &quot;data_import_cleaning/tax.csv&quot;)

# state and its abbreviation
# https://abbreviations.yourdictionary.com/articles/state-abbrev.html
state_ref = 
  read.delim(&quot;./data_import_cleaning/state_abbreviation.txt&quot;, header = F) %&gt;%
  separate(V1, into = c(&quot;state&quot;, &quot;state_abbrv&quot;), sep = &quot; - &quot;) 

# jurisdiction information
license = 
  read_table(&quot;./data_import_cleaning/license_jurisdiction_modified.txt&quot;) %&gt;%
  unlist()
control = 
  read_table(&quot;./data_import_cleaning/control_jurisdiction_modified.txt&quot;) %&gt;%
  unlist()

# tidy tax data: state with abbreviation + group
# to be consistent with other plots, remove year 2008, 2009 (starting year is 2010)
tax_df_group =  
  left_join(tax_df %&gt;% rename(state_abbrv = state), 
            state_ref, by = &quot;state_abbrv&quot;) %&gt;% 
  mutate(
    group = ifelse(state %in% license, &quot;licensed&quot;, 
                   ifelse(state %in% control, &quot;control&quot;, &quot;NA&quot;))
  ) %&gt;% 
  relocate(state_abbrv, state, group) %&gt;% 
  slice(-52) %&gt;% 
  select(-`2008`, -`2009`)

# Merge dataset: tax_df_group + state_df
reg_df = 
  tax_df_group %&gt;% 
  pivot_longer(
    &quot;2010&quot;:&quot;2019&quot;, 
    names_to = &quot;year&quot;, 
    values_to = &quot;total_tax&quot;
  ) %&gt;% 
  mutate(year = as.numeric(year)) %&gt;% 
  left_join(., state_df, by = c(&quot;state&quot;, &quot;year&quot;)) %&gt;% 
  select(total_tax, group, year, shipments, population, consumption)

# Replace 0&#39;s with NA&#39;s
reg_df[reg_df == 0] &lt;- NA

# Fit model
lm_model = lm(total_tax ~ group + year + shipments + population + consumption, data = reg_df)
summary(lm_model)
## 
## Call:
## lm(formula = total_tax ~ group + year + shipments + population + 
##     consumption, data = reg_df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -90576 -15530  -4738  10976 193775 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -1.415e+07  9.800e+05 -14.437  &lt; 2e-16 ***
## grouplicensed -7.551e+03  2.973e+03  -2.540 0.011382 *  
## year           7.012e+03  4.858e+02  14.434  &lt; 2e-16 ***
## shipments     -9.523e-03  2.279e-03  -4.179 3.46e-05 ***
## population     1.365e-02  2.033e-03   6.714 5.17e-11 ***
## consumption    1.189e+03  3.396e+02   3.501 0.000504 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 30570 on 500 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.5548, Adjusted R-squared:  0.5503 
## F-statistic: 124.6 on 5 and 500 DF,  p-value: &lt; 2.2e-16

broom::tidy(lm_model) %&gt;% 
  mutate_at(2:5, round, 2) %&gt;% 
  janitor::clean_names() %&gt;% 
  rename(
    Variable = term,
    Coefficient = estimate, 
    `Standard Error` = std_error,
    `t-Statistic` = statistic, 
    `P-value` = p_value
  ) %&gt;% 
  mutate(
    Variable = ifelse(Variable == &quot;grouplicensed&quot;, &quot;Licensed Group&quot;, Variable), 
    Variable = str_to_title(Variable)
  ) %&gt;% 
  DT::datatable(., rownames = F, 
                options = list(pageLength = 10)) %&gt;% 
  DT::formatStyle(
    columns = &quot;P-value&quot;,
    background = DT::styleInterval(c(0.05),c(&quot;lightsteelblue&quot;,&quot;white&quot;)), 
    target = &quot;row&quot;)</code></pre>
<div id="htmlwidget-37c8f806afac02ba600b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-37c8f806afac02ba600b">{"x":{"filter":"none","data":[["(Intercept)","Licensed Group","Year","Shipments","Population","Consumption"],[-14148057.06,-7551.04,7011.78,-0.01,0.01,1188.99],[980018.67,2972.68,485.77,0,0,339.58],[-14.44,-2.54,14.43,-4.18,6.71,3.5],[0,0.01,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Coefficient<\/th>\n      <th>Standard Error<\/th>\n      <th>t-Statistic<\/th>\n      <th>P-value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[4]; $(row).css({'background':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightsteelblue\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<p>[ends here]</p>
</div>
<div id="discussion" class="section level3">
<h3>Discussion:</h3>
<p>What were your findings? Are they what you expect? What insights into the data can you make?</p>
<p>Discuss in the meeting.</p>
</div>
<div id="resources" class="section level3">
<h3>Resources:</h3>
<ul>
<li><a href="https://www.ttb.gov/alcohol/beverage-alcohol">TTB.gov</a></li>
<li>The Lady Tasting Tea by David Salsurg (page 26-28)</li>
<li><a href="https://www.ttb.gov/beer/statistics">TTB.gov—Beer Statistics. (n.d.). Retrieved November 6, 2020</a></li>
<li><a href="https://www.ttb.gov/alcohol/beverage-alcohol">TTB.gov—Beer Alcohol. (n.d.). Retrieved November 6, 2020</a></li>
<li><a href="https://www.beerinstitute.org/beer-policy/overview/">Beer Institute</a></li>
<li><a href="https://data.opendatasoft.com/explore/dataset/open-beer-database%40public-us/table/">Open Beer Dataset. (n.d.). Retrieved November 6, 2020</a></li>
<li><a href="https://www.beerinstitute.org/news-media/additional-beer-resources/beer-american-history/">Beer &amp; American History</a></li>
<li><a href="https://www.nbwa.org/sites/default/files/NBWA_Report_2009.pdf">KPMG</a></li>
<li><a href="https://www.finance.senate.gov/imo/media/doc/Beer%20Institue%204.pdf">Beer Tax Facts</a></li>
<li><a href="https://www.nbwa.org/government/state-policy-issues">American’s Beer Distributor</a></li>
<li><a href="https://www.nbwa.org/government/benefits-of-beer-franchise-laws">Beer franchise law</a></li>
<li><a href="https://www.alcohollawreview.com/category/alcohol-regulation/">Alcohol Law Review</a></li>
</ul>
</div>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">


 
<hr />
<p style="text-align: center;">
A work by <a href="https://github.com/amypitts01">Amy Pitts</a>, <a href="https://github.com/ruiyangli1">Ruiyang Li</a>, <a href="https://github.com/Wenbofei">Wenbo Fei</a>, and <a href="https://github.com/iriswangziyi">Ziyi (Iris) Wang</a>
</p>
<p style="text-align: center;">
Visualizations and analyses performed using <a href="https://www.r-project.org/about.html">R</a> (v4.0.2) and <a href="https://rstudio.com">RStudio</a> (v1.3.1073).
</p>
<p style="text-align: center;">
© Copyright 2020 The Beer Project Team, All Rights Reserved | Powered by Github.io
</p>

<p> </p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
