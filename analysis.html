<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Analysis</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.16/datatables.js"></script>
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Taxation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="taxation.html">Taxation Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_tax_state_map.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Consumption
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="consumption.html">Consumption Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_comsum_statemap.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Production
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="production.html">Production Analysis</a>
    </li>
    <li>
      <a href="viz_tax_statemap/dashboard_production.html">Data Exploration</a>
    </li>
  </ul>
</li>
<li>
  <a href="analysis.html">Statistical Analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Report.html">Project Report</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-envelope fa-lg"></span>
     
    Contact Us
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mailto:&lt;ajp2257@columbia.edu&gt;">Amy Pitts</a>
    </li>
    <li>
      <a href="mailto:&lt;rl3034@columbia.edu&gt;">Ruiyang Li</a>
    </li>
    <li>
      <a href="mailto:&lt;wf2270@columbia.edu&gt;">Wenbo Fei</a>
    </li>
    <li>
      <a href="mailto:&lt;ziyi.w@columbia.edu&gt;">Ziyi (Iris) Wang</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://www.youtube.com/">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/iriswangziyi/p8105_final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Analysis</h1>

</div>


<p>We focus on two analyses in this section. One is to compare tax differences by jurisdiction group over time. The other is to model taxation under the regression analysis framework.</p>
<hr />
<div id="preliminary-analysis" class="section level1">
<h1>Preliminary Analysis</h1>
<p><span class="math inline">\(~\)</span></p>
<div id="goal" class="section level2">
<h2>Goal</h2>
<p><strong>To Compare Tax differences by jurisdiction group</strong></p>
<p>Differing on the degree of control on liquor wholesales and retail, states can be categorized into two <a href="https://www.ncsla.org/State-Officials.html">types</a> – control jurisdiction and licensed jurisdiction, with licensed states having more control. Such categorization may lead to difference in taxation. Therefore, we are interested in examining if there is any difference in taxation by these two groups of states.</p>
<p>For viewing convenience, we display a state map showing the control jurisdiction and the licensed jurisdiction.</p>
<pre class="r"><code>us_states &lt;- map_data(&quot;state&quot;)

states_map = 
  us_states %&gt;% 
  mutate(
    state_group = 
      ifelse(region %in% str_to_lower(license), &quot;licensed&quot;, 
             ifelse(region %in% str_to_lower(control), &quot;control&quot;, &quot;NA&quot;))
  )

theme_map &lt;- function(base_size = 9, base_family = &quot;&quot;) {
    require(grid)
    theme_bw(base_size = base_size, base_family = base_family) %+replace%
        theme(axis.line = element_blank(),
              axis.text = element_blank(),
              axis.ticks = element_blank(),
              axis.title = element_blank(),
              panel.background = element_blank(),
              panel.border = element_blank(),
              panel.grid = element_blank(),
              panel.spacing = unit(0, &quot;lines&quot;),
              plot.background = element_blank(),
              legend.justification = c(0,0),
              legend.position = c(0,0)
              )
}
p0 &lt;- ggplot(data = states_map,
             mapping = aes(x = long, y = lat,
                           group = group, fill = state_group)) +
  scale_fill_manual(values = c(&quot;snow3&quot;, &quot;steelblue&quot;))
p1 &lt;- p0 + geom_polygon(color = &quot;gray90&quot;, size = 0.1) +
    coord_map(projection = &quot;albers&quot;, lat0 = 39, lat1 = 45) 
p2 &lt;- p1 +
    labs(title = &quot;Jurisdiction Group&quot;, fill = NULL)
p3 &lt;- p2 + theme_map()

centroids &lt;- data.frame(region = tolower(state.name), 
                        long = state.center$x, lat = state.center$y)
centroids$abb &lt;- state.abb[match(centroids$region, tolower(state.name))]

# Collect names of the 32 states in my data.
statenames &lt;- data.frame(region = unique(states_map$region)) 
# Merge it with centroids
centroids &lt;- merge(statenames, centroids, by = &quot;region&quot;)

p3 + 
  with(centroids, 
       annotate(geom = &quot;text&quot;, x = long, y = lat, label = abb, 
                size = 2.3, color = &quot;gray30&quot;)
      )</code></pre>
<p><img src="analysis_files/figure-html/state_map-1.png" width="672" /></p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="cumulative-tax-collected" class="section level2">
<h2>Cumulative Tax Collected</h2>
<p>First, we looked at the cumulative taxes collected. This tax is specifically looking at the “Beer removed for consumption or sale including beer removed tax determined for consumption or sale in a tavern or on brewery premises”.</p>
<p>We performed t-test for each year and would like to see if the cumulative taxes collected differ significantly between the control states and the licensed states.</p>
<p>The following plot gives the average tax difference (Tax in the Control States - Tax in the Licensed States), together with its 95% confidence interval and p-value, from 2010 to 2019.</p>
<p>We can see that the mean difference in the cumulative tax collected does not deviate much from 0 for all years, though the confidence interval seems to have a fan shape over time. Large p-values from t-tests also suggest that there is <strong>no sufficient evidence showing any significant difference between two jurisdiction groups in the cumulative tax collected from 2010 to 2019</strong>.</p>
<pre class="r"><code># tax
year = colnames(tax_df_group)[-c(1:3)]
t_test_output = NULL
for (i in 1:length(year)) {
  t_test = t.test(tax_df_group[[year[i]]]~group, data = tax_df_group) %&gt;% broom::tidy()
  t_test_output = rbind(t_test_output, t_test)
}

tax_group_result = 
  t_test_output %&gt;% 
  mutate(year = year) %&gt;% 
  relocate(year) %&gt;% 
  rename(
    control_est = estimate1, 
    licensed_est = estimate2, 
    control_minus_licensed = estimate) %&gt;% 
  select(year, control_minus_licensed, p.value, conf.low, conf.high) %&gt;% 
  janitor::clean_names() %&gt;% 
  mutate(
    control_minus_licensed = control_minus_licensed / 1000,
    conf_low = conf_low / 1000, 
    conf_high = conf_high / 1000) %&gt;% 
  mutate_at(2:3, round, 2)

tax_group_result %&gt;% 
  mutate(year = as.character(year)) %&gt;% 
  ggplot(aes(x = year, y = control_minus_licensed)) +
  geom_point() + 
  geom_errorbar(aes(ymin = conf_low, ymax = conf_high)) +
  labs(
    title = &quot;Difference in Cumulative Tax between Control and Licensed Groups over time&quot;,
    subtitle = &quot;Tax difference in orange; p-value in parentheses&quot;,
    y = &quot;Tax Difference (Control - Licensed) (in thousand $)&quot;, 
    x = &quot;Year&quot;) + 
  geom_text(
    aes(label = paste0(&quot;(&quot;, p_value, &quot;)&quot;)), 
    color = &quot;steelblue&quot;, hjust = -0.05, vjust = -3.7, angle = 20) + 
  geom_text(
    aes(label = control_minus_licensed), 
    color = &quot;#D14124&quot;, hjust = 0.6, vjust = 1.5, angle = 20)</code></pre>
<p><img src="analysis_files/figure-html/tax_group-1.png" width="672" /></p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="tax-per-barrel" class="section level2">
<h2>Tax per Barrel</h2>
<p>Next, we looked at the tax per barrel, which is the effective excise tax (volume adjusted). Similar to what have been done in previous subsection, we performed t-test for each year and would like to see if there is any significant difference in the tax per barrel between the control states and the licensed states.</p>
<p>The following plot gives the average tax difference (Tax in the Control States - Tax in the Licensed States), together with its 95% confidence interval and p-value, from 2010 to 2019.</p>
<p>We can see that the mean difference in the tax per barrel does not deviate much from 0 for all years, and the confidence interval seems to be consistently wide over time. Large p-values from t-tests again suggest that there is <strong>no sufficient evidence showing any significant difference between two jurisdiction groups in the tax per barrel from 2010 to 2019</strong>.</p>
<pre class="r"><code># state_tax

state_tax_group_result = 
  state_tax_df_group %&gt;% 
  nest(data = -year) %&gt;% 
  mutate(
    t_test = purrr::map(.x = data, ~t.test(adjusted ~ group, data = .x)),
    result = purrr::map(t_test, broom::tidy)
  ) %&gt;% 
  select(year, result) %&gt;% 
  unnest(result) %&gt;% 
  rename(control_est = estimate1, 
         licensed_est = estimate2,
         control_minus_licensed = estimate) %&gt;% 
  select(year, control_minus_licensed, p.value, conf.low, conf.high) %&gt;% 
  janitor::clean_names() %&gt;% 
  mutate_at(2:3, round, 2)

state_tax_group_result %&gt;% 
  mutate(year = as.character(year)) %&gt;% 
  ggplot(aes(x = year, y = control_minus_licensed)) +
  geom_point() + 
  geom_errorbar(aes(ymin = conf_low, ymax = conf_high)) +
  labs(
    title = &quot;Difference in Tax per Barrel between Control and Licensed Groups over time&quot;,
    subtitle = &quot;Tax difference in orange; p-value in parentheses&quot;,
    y = &quot;Tax Difference (Control - Licensed) in $&quot;,
    x = &quot;Year&quot;) + 
  geom_text(
    aes(label = paste0(&quot;(&quot;, p_value, &quot;)&quot;)), 
    color = &quot;steelblue&quot;, hjust = -0.05, vjust = -3.5, angle = 20) +
  geom_text(
    aes(label = control_minus_licensed), 
    color = &quot;#D14124&quot;, hjust = 0.6, vjust = 2, angle = 20)</code></pre>
<p><img src="analysis_files/figure-html/state_tax_group-1.png" width="672" /></p>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="recap" class="section level2">
<h2>Recap</h2>
<ul>
<li><strong>Cumulative tax collected</strong> does <strong>not differ significantly by jurisdiction groups</strong> from 2010 to 2019.</li>
<li><strong>Tax per barrel</strong> does <strong>not differ significantly by jurisdiction groups</strong> from 2010 to 2019.</li>
</ul>
<hr />
</div>
</div>
<div id="regression-anlaysis" class="section level1">
<h1>Regression Anlaysis</h1>
<p>In this part, we would like to explore more regarding the relationship between taxation and jurisdiction group, year, shipments, population, and consumption. To be consistent with our focus in the previous section, we fit two regression models – one for the cumulative tax collected and the other for the tax per barrel.</p>
<p><span class="math inline">\(~\)</span></p>
<div id="variables" class="section level2">
<h2>Variables</h2>
<p>Our explaining variables of interest include jurisdiction group, year, shipments, population, and consumption.</p>
<ul>
<li>group: jurisdiction group (control vs licensed)</li>
<li>shipments: amount of barrels shipped</li>
<li>population: the number of individuals who are 21 years old or older</li>
<li>consumption: consumption of barrels per capita</li>
</ul>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="model-1---cumulative-tax-collected" class="section level2">
<h2>Model 1 - Cumulative Tax Collected</h2>
<p>We first focus on the <strong>cumulative tax collected</strong>. Our model of interest is:</p>
<p><span class="math display">\[Cumulative \ tax = \beta_0 + \beta_1 \ Group + \beta_2 Year + \beta_3 \ Shipments + \beta_4 \ Population+ \beta_5 \ Consumption.\]</span></p>
<p><span class="math inline">\(~\)</span></p>
<div id="results" class="section level3">
<h3>Results</h3>
<p>Variables with significant p-value are highlighted in blue.</p>
<pre class="r"><code># Load state_df
state_df = read_csv(&quot;data_import_cleaning/state_df.csv&quot;)
## Parsed with column specification:
## cols(
##   state = col_character(),
##   shipments = col_double(),
##   rank_3 = col_double(),
##   population = col_double(),
##   consumption = col_double(),
##   rank_6 = col_double(),
##   year = col_double()
## )

# Merge dataset
reg_df = 
  tax_df_group %&gt;% 
  pivot_longer(
    &quot;2010&quot;:&quot;2019&quot;, 
    names_to = &quot;year&quot;, 
    values_to = &quot;total_tax&quot;
  ) %&gt;% 
  mutate(year = as.numeric(year)) %&gt;% 
  left_join(., state_df, by = c(&quot;state&quot;, &quot;year&quot;)) %&gt;% 
  select(total_tax, group, year, shipments, population, consumption)

# Replace 0&#39;s with NA&#39;s
reg_df[reg_df == 0] &lt;- NA

# Fit model
lm_model = lm(total_tax ~ group + year + shipments + population + consumption, data = reg_df)
summary(lm_model)
## 
## Call:
## lm(formula = total_tax ~ group + year + shipments + population + 
##     consumption, data = reg_df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -90576 -15530  -4738  10976 193775 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -1.415e+07  9.800e+05 -14.437  &lt; 2e-16 ***
## grouplicensed -7.551e+03  2.973e+03  -2.540 0.011382 *  
## year           7.012e+03  4.858e+02  14.434  &lt; 2e-16 ***
## shipments     -9.523e-03  2.279e-03  -4.179 3.46e-05 ***
## population     1.365e-02  2.033e-03   6.714 5.17e-11 ***
## consumption    1.189e+03  3.396e+02   3.501 0.000504 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 30570 on 500 degrees of freedom
##   (4 observations deleted due to missingness)
## Multiple R-squared:  0.5548, Adjusted R-squared:  0.5503 
## F-statistic: 124.6 on 5 and 500 DF,  p-value: &lt; 2.2e-16

broom::tidy(lm_model) %&gt;% 
  mutate_at(2:5, format, digits = 2, nsmall = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  rename(
    Variable = term,
    Coefficient = estimate, 
    `Standard Error` = std_error,
    `t-Statistic` = statistic, 
    `P-value` = p_value
  ) %&gt;% 
  mutate(
    Variable = ifelse(Variable == &quot;grouplicensed&quot;, &quot;Licensed Group&quot;, Variable), 
    Variable = str_to_title(Variable)
  ) %&gt;% 
  DT::datatable(., rownames = F, 
                options = list(pageLength = 10)) %&gt;% 
  DT::formatStyle(
    columns = &quot;P-value&quot;,
    background = DT::styleInterval(c(0.05),c(&quot;lightsteelblue&quot;,&quot;white&quot;)), 
    target = &quot;row&quot;)</code></pre>
<div id="htmlwidget-7c54497f34d89be03a88" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7c54497f34d89be03a88">{"x":{"filter":"none","data":[["(Intercept)","Licensed Group","Year","Shipments","Population","Consumption"],["-1.4e+07","-7.6e+03"," 7.0e+03","-9.5e-03"," 1.4e-02"," 1.2e+03"],["9.8e+05","3.0e+03","4.9e+02","2.3e-03","2.0e-03","3.4e+02"],["-14.4"," -2.5"," 14.4"," -4.2","  6.7","  3.5"],["9.7e-40","1.1e-02","9.9e-40","3.5e-05","5.2e-11","5.0e-04"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Coefficient<\/th>\n      <th>Standard Error<\/th>\n      <th>t-Statistic<\/th>\n      <th>P-value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[4]; $(row).css({'background':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightsteelblue\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="interpretation" class="section level3">
<h3>Interpretation</h3>
<ul>
<li>All variables in our model are <strong>significant</strong> at the 5% significance level.</li>
<li>Our model fit is acceptable with an adjusted <span class="math inline">\(R^2 = 0.55\)</span>.</li>
<li>Previously, we did not find any significant difference in the cumulative tax between two jurisdiction groups. However, after controlling for year, shipments, population and consumption, we found that <strong>licensed states</strong> are estimated to have approximately <strong>$7.6k less cumulative tax collected</strong> than the control states.</li>
<li><strong>Cumulative tax collected</strong> is estimate to
<ul>
<li><strong>increase approximately $7k per year</strong>, holding the group, shipments, population and consumption unchanged.</li>
<li><strong>increase approximately $1.2k for one unit increase in consumption per capita</strong>, holding the group, year, shipments, and population unchanged.</li>
<li><strong>increase approximately $14 for each 1k increase in population</strong>, holding the group, year, shipments, and consumption unchanged.</li>
<li><strong>decrease approximately $9.6 for each 1k increase in shipments</strong>, holding the group, year, population, and consumption unchanged.</li>
</ul></li>
</ul>
<p><span class="math inline">\(~\)</span></p>
</div>
</div>
<div id="model-2---tax-per-barrel" class="section level2">
<h2>Model 2 - Tax Per Barrel</h2>
<p>We next look at the <strong>tax per barrel</strong>. Our model of interest is</p>
<p><span class="math display">\[Tax \ per \ barrel = \beta_0 + \beta_1 \ Group + \beta_2 Year + \beta_3 \ Shipments + \beta_4 \ Population+ \beta_5 \ Consumption.\]</span></p>
<p><span class="math inline">\(~\)</span></p>
<div id="results-1" class="section level3">
<h3>Results</h3>
<p>Variables with significant p-value are highlighted in blue.</p>
<pre class="r"><code># Load state_df
state_df = read_csv(&quot;data_import_cleaning/state_df.csv&quot;)
## Parsed with column specification:
## cols(
##   state = col_character(),
##   shipments = col_double(),
##   rank_3 = col_double(),
##   population = col_double(),
##   consumption = col_double(),
##   rank_6 = col_double(),
##   year = col_double()
## )

# Merge dataset
reg_df2 = 
  state_tax_df_group %&gt;% 
  rename(adjusted_tax = adjusted) %&gt;% 
  mutate(year = as.numeric(year)) %&gt;% 
  left_join(., state_df, by = c(&quot;state&quot;, &quot;year&quot;)) %&gt;% 
  select(adjusted_tax, group, year, shipments, population, consumption)

# Replace 0&#39;s with NA&#39;s
reg_df2[reg_df2 == 0] &lt;- NA

# Fit model
lm_model2 = lm(adjusted_tax ~ group + year + shipments + population + consumption, data = reg_df2)
summary(lm_model2)
## 
## Call:
## lm(formula = adjusted_tax ~ group + year + shipments + population + 
##     consumption, data = reg_df2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.989 -4.915 -2.910  1.895 30.936 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   -1.351e+02  2.512e+02  -0.538    0.591
## grouplicensed -2.893e-01  7.591e-01  -0.381    0.703
## year           7.307e-02  1.245e-01   0.587    0.558
## shipments      4.369e-07  5.861e-07   0.745    0.456
## population    -4.517e-07  5.228e-07  -0.864    0.388
## consumption   -9.209e-02  8.731e-02  -1.055    0.292
## 
## Residual standard error: 7.863 on 504 degrees of freedom
## Multiple R-squared:  0.004557,   Adjusted R-squared:  -0.005319 
## F-statistic: 0.4614 on 5 and 504 DF,  p-value: 0.805

broom::tidy(lm_model2) %&gt;% 
  mutate_at(2:5, format, digits = 2, nsmall = 1) %&gt;% 
  janitor::clean_names() %&gt;% 
  rename(
    Variable = term,
    Coefficient = estimate, 
    `Standard Error` = std_error,
    `t-Statistic` = statistic, 
    `P-value` = p_value
  ) %&gt;% 
  mutate(
    Variable = ifelse(Variable == &quot;grouplicensed&quot;, &quot;Licensed Group&quot;, Variable), 
    Variable = str_to_title(Variable)
  ) %&gt;% 
  DT::datatable(., rownames = F, 
                options = list(pageLength = 10)) %&gt;% 
  DT::formatStyle(
    columns = &quot;P-value&quot;,
    background = DT::styleInterval(c(0.05),c(&quot;lightsteelblue&quot;,&quot;white&quot;)), 
    target = &quot;row&quot;)</code></pre>
<div id="htmlwidget-4ca159979de1d36e8fb5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4ca159979de1d36e8fb5">{"x":{"filter":"none","data":[["(Intercept)","Licensed Group","Year","Shipments","Population","Consumption"],["-1.4e+02","-2.9e-01"," 7.3e-02"," 4.4e-07","-4.5e-07","-9.2e-02"],["2.5e+02","7.6e-01","1.2e-01","5.9e-07","5.2e-07","8.7e-02"],["-0.54","-0.38"," 0.59"," 0.75","-0.86","-1.05"],["0.59","0.70","0.56","0.46","0.39","0.29"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Variable<\/th>\n      <th>Coefficient<\/th>\n      <th>Standard Error<\/th>\n      <th>t-Statistic<\/th>\n      <th>P-value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nvar value=data[4]; $(row).css({'background':isNaN(parseFloat(value)) ? '' : value <= 0.05 ? \"lightsteelblue\" : \"white\"});\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<p><span class="math inline">\(~\)</span></p>
</div>
<div id="interpretation-1" class="section level3">
<h3>Interpretation</h3>
<ul>
<li>All variables in our model are <strong>not significant</strong> at the 5% significance level.</li>
<li>This model does not fit well as the adjusted <span class="math inline">\(R^2\)</span> is approximately 0.</li>
</ul>
<hr />
</div>
</div>
</div>
<div id="highlights" class="section level1">
<h1>Highlights</h1>
<ul>
<li>Our data suggested that <strong>tax per barrel</strong> does <strong>not differ significantly by jurisdiction groups</strong> from 2010 to 2019.</li>
<li>After controlling for year, amount of barrels shipped, population above 21 years old and consumption of barrels per capita, we found that <strong>licensed states</strong> are estimated to have <strong>less cumulative tax collected</strong> than the control states from 2010 to 2019.
<ul>
<li>In addition, <strong>Cumulative tax collected</strong> is estimate to <strong>increase</strong> with <strong>year, consumption per capita and population</strong> but <strong>decrease</strong> with <strong>shipments</strong>.</li>
</ul></li>
</ul>
<p><span class="math inline">\(~\)</span></p>
</div>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">


 
<hr />
<p style="text-align: center;">
A work by <a href="https://github.com/amypitts01">Amy Pitts</a>, <a href="https://github.com/ruiyangli1">Ruiyang Li</a>, <a href="https://github.com/Wenbofei">Wenbo Fei</a>, and <a href="https://github.com/iriswangziyi">Ziyi (Iris) Wang</a>
</p>
<p style="text-align: center;">
Visualizations and analyses performed using <a href="https://www.r-project.org/about.html">R</a> (v4.0.2) and <a href="https://rstudio.com">RStudio</a> (v1.3.1073).
</p>
<p style="text-align: center;">
© Copyright 2020 The Beer Project Team, All Rights Reserved | Powered by Github.io
</p>

<p> </p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
